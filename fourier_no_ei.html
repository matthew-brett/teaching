<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fourier without the ei &#8212; Tutorials on imaging, computing and mathematics</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/copybutton.js?v=fc45e087"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fourier without the ei" href="fourier_no_ei_orig.html" />
    <link rel="prev" title="The Fourier basis" href="fourier_basis.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><span class="math notranslate nohighlight">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<section id="fourier-without-the-ei">
<h1>Fourier without the ei<a class="headerlink" href="#fourier-without-the-ei" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The standard equations for discrete Fourier transforms (DFTs) involve
exponentials to the power of <span class="math notranslate nohighlight">\(i\)</span> - the imaginary unit. I
personally find these difficult to think about, and it turns out, the
DFT is fairly easy to recast in terms of <span class="math notranslate nohighlight">\(\sin\)</span> and <span class="math notranslate nohighlight">\(\cos\)</span>.
This page goes through this process, and tries to show how thinking in
this way can explain some features of the DFT.</p>
<section id="how-hard-is-the-mathematics">
<h3>How hard is the mathematics?<a class="headerlink" href="#how-hard-is-the-mathematics" title="Link to this heading">¶</a></h3>
<p>You will not need heavy mathematics to follow this page. If you don’t remember
the following concepts you might want to brush up on them. There are also links
to proofs and explanations for these ideas in the page as we go along:</p>
<ul class="simple">
<li><p>basic trigonometry (SOH CAH TOA, Pythagoras’ theorem);</p></li>
<li><p>the <a class="reference internal" href="angle_sum.html"><span class="doc">angle sum rule</span></a>;</p></li>
<li><p><a class="reference internal" href="some_sums.html"><span class="doc">basic algebra with sums</span></a>;</p></li>
<li><p><a class="reference internal" href="on_vectors.html"><span class="doc">Vectors and dot products</span></a>;</p></li>
</ul>
<p>You will not need to go deep into complex numbers, but see
<a class="reference internal" href="simple_complex.html"><span class="doc">Refresher on complex numbers</span></a>.</p>
</section>
<section id="loading-and-configuring-code-libraries">
<h3>Loading and configuring code libraries<a class="headerlink" href="#loading-and-configuring-code-libraries" title="Link to this heading">¶</a></h3>
<p>Load and configure the Python libraries we will use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># the Python array package</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># the Python plotting package</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Tell numpy to print numbers to 4 decimal places only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If running in the IPython console, consider running <code class="docutils literal notranslate"><span class="pre">%matplotlib</span></code> to enable
interactive plots.  If running in the Jupyter Notebook, use <code class="docutils literal notranslate"><span class="pre">%matplotlib</span>
<span class="pre">inline</span></code>.</p>
</div>
</section>
</section>
<section id="some-actual-numbers-to-start">
<h2>Some actual numbers to start<a class="headerlink" href="#some-actual-numbers-to-start" title="Link to this heading">¶</a></h2>
<p>Let us start with a DFT of some data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># An example input vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.4967</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1383</span><span class="p">,</span>  <span class="mf">0.6477</span><span class="p">,</span>  <span class="mf">1.523</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.2342</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2341</span><span class="p">,</span>  <span class="mf">1.5792</span><span class="p">,</span>
<span class="gp">... </span>      <span class="mf">0.7674</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4695</span><span class="p">,</span>  <span class="mf">0.5426</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4634</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4657</span><span class="p">,</span>  <span class="mf">0.242</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.9133</span><span class="p">,</span>
<span class="gp">... </span>     <span class="o">-</span><span class="mf">1.7249</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5623</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0128</span><span class="p">,</span>  <span class="mf">0.3142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.908</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.4123</span><span class="p">,</span>  <span class="mf">1.4656</span><span class="p">,</span>
<span class="gp">... </span>     <span class="o">-</span><span class="mf">0.2258</span><span class="p">,</span>  <span class="mf">0.0675</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4247</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5444</span><span class="p">,</span>  <span class="mf">0.1109</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.151</span> <span class="p">,</span>  <span class="mf">0.3757</span><span class="p">,</span>
<span class="gp">... </span>     <span class="o">-</span><span class="mf">0.6006</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2917</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6017</span><span class="p">,</span>  <span class="mf">1.8523</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span>
<span class="go">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei-3.png">png</a>, <a class="reference external" href=".//fourier_no_ei-3.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei-3.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei-3.png" src="_images/fourier_no_ei-3.png" />
</figure>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now the DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span>
<span class="go">array([-4.3939+0.j    ,  9.0217-3.7036j, -0.5874-6.2268j,  2.5184+3.7749j,</span>
<span class="go">        0.5008-0.8433j,  1.2904-0.4024j,  4.3391+0.8079j, -6.2614+2.1596j,</span>
<span class="go">        1.8974+2.4889j,  0.1042+7.6169j,  0.3606+5.162j ,  4.7965+0.0755j,</span>
<span class="go">       -5.3064-3.2329j,  4.6237+1.5287j, -2.1211+4.4873j, -4.0175-0.3712j,</span>
<span class="go">       -2.0297+0.j    , -4.0175+0.3712j, -2.1211-4.4873j,  4.6237-1.5287j,</span>
<span class="go">       -5.3064+3.2329j,  4.7965-0.0755j,  0.3606-5.162j ,  0.1042-7.6169j,</span>
<span class="go">        1.8974-2.4889j, -6.2614-2.1596j,  4.3391-0.8079j,  1.2904+0.4024j,</span>
<span class="go">        0.5008+0.8433j,  2.5184-3.7749j, -0.5874+6.2268j,  9.0217+3.7036j])</span>
</pre></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">X</span></code> - the output of the forward DFT - is a vector of complex
numbers.</p>
<p>Each value in <code class="docutils literal notranslate"><span class="pre">X</span></code> gives the scaling for a sinusoid for a particular
frequency.</p>
<p>If the input to the DFT is real, as here, then:</p>
<ul class="simple">
<li><p>The real part of <code class="docutils literal notranslate"><span class="pre">X</span></code> has the scaling for a cosine at the particular
frequency;</p></li>
<li><p>The imaginary part of <code class="docutils literal notranslate"><span class="pre">X</span></code> has the scaling for a sine at that frequency.</p></li>
</ul>
<p>There are some patterns to these numbers.  Notice that the numbers at index 0
and N/2 (=16) have 0 for their imaginary part, and that <code class="docutils literal notranslate"><span class="pre">X[17:]</span></code> is a mirror
image of <code class="docutils literal notranslate"><span class="pre">X[1:16]</span></code>, with the imaginary parts having the opposite sign.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span>
<span class="go">array([ 9.0217-3.7036j, -0.5874-6.2268j,  2.5184+3.7749j,  0.5008-0.8433j,</span>
<span class="go">        1.2904-0.4024j,  4.3391+0.8079j, -6.2614+2.1596j,  1.8974+2.4889j,</span>
<span class="go">        0.1042+7.6169j,  0.3606+5.162j ,  4.7965+0.0755j, -5.3064-3.2329j,</span>
<span class="go">        4.6237+1.5287j, -2.1211+4.4873j, -4.0175-0.3712j])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">[</span><span class="mi">17</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([ 9.0217+3.7036j, -0.5874+6.2268j,  2.5184-3.7749j,  0.5008+0.8433j,</span>
<span class="go">        1.2904+0.4024j,  4.3391-0.8079j, -6.2614-2.1596j,  1.8974-2.4889j,</span>
<span class="go">        0.1042-7.6169j,  0.3606-5.162j ,  4.7965-0.0755j, -5.3064+3.2329j,</span>
<span class="go">        4.6237-1.5287j, -2.1211-4.4873j, -4.0175+0.3712j])</span>
</pre></div>
</div>
<p>These features constitute <em>conjugate symmetry</em> and are always true of a DFT on
real numbers.  We will soon see why.</p>
<p>When we do the inverse DFT on <code class="docutils literal notranslate"><span class="pre">X</span></code> we return the original values of our
input <code class="docutils literal notranslate"><span class="pre">x</span></code>, but as complex numbers with imaginary part 0:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the inverse DFT to the output of the forward DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_back</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_back</span>
<span class="go">array([ 0.4967-0.j, -0.1383-0.j,  0.6477-0.j,  1.5230-0.j, -0.2342-0.j,</span>
<span class="go">       -0.2341+0.j,  1.5792+0.j,  0.7674+0.j, -0.4695-0.j,  0.5426-0.j,</span>
<span class="go">       -0.4634-0.j, -0.4657+0.j,  0.2420-0.j, -1.9133-0.j, -1.7249-0.j,</span>
<span class="go">       -0.5623+0.j, -1.0128-0.j,  0.3142+0.j, -0.9080+0.j, -1.4123+0.j,</span>
<span class="go">        1.4656+0.j, -0.2258+0.j,  0.0675+0.j, -1.4247-0.j, -0.5444+0.j,</span>
<span class="go">        0.1109+0.j, -1.1510+0.j,  0.3757-0.j, -0.6006-0.j, -0.2917-0.j,</span>
<span class="go">       -0.6017-0.j,  1.8523-0.j])</span>
</pre></div>
</div>
</section>
<section id="traditional-notation-for-the-discrete-fourier-transform">
<h2>Traditional notation for the discrete Fourier transform<a class="headerlink" href="#traditional-notation-for-the-discrete-fourier-transform" title="Link to this heading">¶</a></h2>
<p>Let us say we have a vector of <span class="math notranslate nohighlight">\(N\)</span> values in time, or space
<span class="math notranslate nohighlight">\(\vec{x} = [x_0, x_1 ... x_{N-1}]\)</span>. We generally index
<span class="math notranslate nohighlight">\(\vec{x}\)</span> with subscript <span class="math notranslate nohighlight">\(n\)</span>, so the sample at index
<span class="math notranslate nohighlight">\(n\)</span> is <span class="math notranslate nohighlight">\(x_n\)</span>.</p>
<p>The DFT converts <span class="math notranslate nohighlight">\(\vec{x}\)</span> from a vector in time, or space, to a
vector <span class="math notranslate nohighlight">\(\vec{X}\)</span> representing temporal or spatial frequency
components.</p>
<p>We will call our original <span class="math notranslate nohighlight">\(\vec{x}\)</span> the <em>signal</em>, meaning, the
signal not transformed to frequency.</p>
<p>The DFT converts <span class="math notranslate nohighlight">\(\vec{x}\)</span> to <span class="math notranslate nohighlight">\(\vec{X}\)</span> where
<span class="math notranslate nohighlight">\(\vec{X} = [X_0, X_1, ... X_{N-1}]\)</span>. We generally index
<span class="math notranslate nohighlight">\(\vec{X}\)</span> with subscript <span class="math notranslate nohighlight">\(k\)</span>, so the sample at index
<span class="math notranslate nohighlight">\(k\)</span> is <span class="math notranslate nohighlight">\(X_k\)</span>.</p>
<p>Here is the equation for the discrete Fourier transform:</p>
<div class="math notranslate nohighlight" id="equation-forward-dft">
<span class="eqno">(1)<a class="headerlink" href="#equation-forward-dft" title="Link to this equation">¶</a></span>\[X_k = \sum_{n=0}^{N-1} x_n \; e^{-i 2 \pi \frac{k}{N} n}\]</div>
<p>This is the transform from signal to frequency. We will call this the
<em>forward</em> Fourier transform.</p>
<p>Here is the equation for the inverse Fourier transform:</p>
<div class="math notranslate nohighlight" id="equation-inverse-dft">
<span class="eqno">(2)<a class="headerlink" href="#equation-inverse-dft" title="Link to this equation">¶</a></span>\[x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k \; e^{i 2 \pi \frac{k}{N} n}\]</div>
<p>The inverse Fourier transform converts from frequency back to signal.</p>
<section id="dft-and-fft">
<h3>DFT and FFT<a class="headerlink" href="#dft-and-fft" title="Link to this heading">¶</a></h3>
<p>The fast Fourier transform (FFT) refers to a particular set of - er - fast
algorithms for calculating the DFT. It is common, but confusing, to use “FFT”
to mean DFT.</p>
</section>
</section>
<section id="rewriting-the-dft-without-the-e-i">
<h2>Rewriting the DFT without the <span class="math notranslate nohighlight">\(e^i\)</span><a class="headerlink" href="#rewriting-the-dft-without-the-e-i" title="Link to this heading">¶</a></h2>
<section id="why-rewrite-without-e-i">
<h3>Why rewrite without <span class="math notranslate nohighlight">\(e^i\)</span>?<a class="headerlink" href="#why-rewrite-without-e-i" title="Link to this heading">¶</a></h3>
<p>The forward and inverse equations are very similar; both share a term
<span class="math notranslate nohighlight">\(e^{iz}\)</span>, where <span class="math notranslate nohighlight">\(z = -2 \pi \frac{k}{N} n\)</span> for the forward
transform; <span class="math notranslate nohighlight">\(z = 2 \pi \frac{k}{N} n\)</span> for the inverse transform.</p>
<p>Some people are used to looking at the form <span class="math notranslate nohighlight">\(e^{iz}\)</span> and thinking
“aha, that’s a rotation around a circle”. Apparently this is an
intuition that builds up over time working with these sorts of
equations.</p>
<p>Unfortunately, some of us find it hard to think in complex exponentials,
or in terms of complex numbers.</p>
<p>So, in this tutorial, we will express the Fourier transform in terms of
<span class="math notranslate nohighlight">\(\sin\)</span> and <span class="math notranslate nohighlight">\(\cos\)</span>. We will be using complex numbers, but
almost entirely as a pair of numbers to represent two components of the
same thing, rather than a single number with a real and imaginary part.</p>
<p>Having said that, we will need some very basic properties of complex and
imaginary numbers - see <a class="reference internal" href="simple_complex.html"><span class="doc">Refresher on complex numbers</span></a>.</p>
</section>
<section id="how-to-rewrite-without-e-i">
<h3>How to rewrite without <span class="math notranslate nohighlight">\(e^i\)</span><a class="headerlink" href="#how-to-rewrite-without-e-i" title="Link to this heading">¶</a></h3>
<p>Our first tool in this enterprise is Euler’s formula:</p>
<div class="math notranslate nohighlight">
\[e^{i\theta} = \cos \theta + i \sin \theta\]</div>
<p>This is the basis for thinking of <span class="math notranslate nohighlight">\(e^{i \theta}\)</span> as being rotation
around a circle, of which you will hear no more in this page. In our case, it
allows us to rewrite the forward and inverse Fourier transforms:</p>
<p>First let’s define a new value <span class="math notranslate nohighlight">\(D\)</span>, that depends on <span class="math notranslate nohighlight">\(N\)</span> - the
number of observations in our vector <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-d">
<span class="eqno">(3)<a class="headerlink" href="#equation-d" title="Link to this equation">¶</a></span>\[D \triangleq \frac{2 \pi}{N}\]</div>
<p>With that value:</p>
<div class="math notranslate nohighlight">
\[X_k = \sum_{n=0}^{N-1} x_n \cos(-k n D) +
i \sum_{n=0}^{N-1} x_n \sin(-k n D)\]</div>
<p>We can simplify this further, because, for any angle <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\cos(-\theta) = cos(\theta) \\
\sin(-\theta) = -sin(\theta)\end{split}\]</div>
<div class="math notranslate nohighlight">
\[X_k = \sum_{n=0}^{N-1} x_n \cos(k n D) -
i \sum_{n=0}^{N-1} x_n \sin(k n D)\]</div>
<p>Following the same logic for the inverse transform:</p>
<div class="math notranslate nohighlight">
\[x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k \cos(n k D)
+ i \frac{1}{N} \sum_{k=0}^{N-1} X_k \sin(n k D)\]</div>
</section>
<section id="rewriting-the-dft-with-vectors">
<span id="rewriting-dft-with-vectors"></span><h3>Rewriting the DFT with vectors<a class="headerlink" href="#rewriting-the-dft-with-vectors" title="Link to this heading">¶</a></h3>
<p>We can write the elements inside the DFT summations as values from vectors:</p>
<div class="math notranslate nohighlight">
\[X_k = \sum_{n=0}^{N-1} x_n \cos(r^k_n)
- i \sum_{n=0}^{N-1} x_n \sin(r^k_n)\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\vec{r^k} \triangleq \left[ k 0 D, k 1 D, \ldots, k (N - 1) D \right]\]</div>
<p>Call <span class="math notranslate nohighlight">\(\vec{r^k}\)</span> the <em>angle vector</em> for <span class="math notranslate nohighlight">\(k\)</span>.  This vector depend only on <span class="math notranslate nohighlight">\(k\)</span>
and <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>Substituting the value of <span class="math notranslate nohighlight">\(D\)</span> (equation <a class="reference internal" href="#equation-d">(3)</a>):</p>
<div class="math notranslate nohighlight">
\[\vec{r^k} = [ k 2 \pi \frac{0}{N}, k 2 \pi \frac{1}{N}, \ldots,
k 2 \pi \frac{N-1}{N}]\]</div>
<p>Now define:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{c^k} \triangleq \left[ \cos(r^k_0), \cos(r^k_1), \ldots,
\cos(r^k_{N-1}) \right] \\
\vec{s^k} \triangleq \left[ \sin(r^k_0), \sin(r^k_1), \ldots,
\sin(r^k_{N-1}) \right]\end{split}\]</div>
<p>We have:</p>
<div class="math notranslate nohighlight">
\[X_k = \sum_{n=0}^{N-1} x_n c^k_n
- i \sum_{n=0}^{N-1} x_n s^k_n\]</div>
<p>Given the definition of the <a class="reference internal" href="on_vectors.html#vector-dot-product"><span class="std std-ref">Vector dot product</span></a>, we can write the
forward DFT as:</p>
<div class="math notranslate nohighlight">
\[X_k = \vec{x} \cdot \vec{c^k} - i \vec{x} \cdot \vec{s^k}\]</div>
</section>
<section id="frequency-as-cycles-across-the-sample-vector">
<h3>Frequency as cycles across the sample vector<a class="headerlink" href="#frequency-as-cycles-across-the-sample-vector" title="Link to this heading">¶</a></h3>
<p>The key to the frequencies in the DFT is in the <span class="math notranslate nohighlight">\(n k D = k 2 \pi \frac{n}{N}\)</span>
values that we have put into the angle vector <span class="math notranslate nohighlight">\(\vec{r^k}\)</span>.</p>
<p>The <span class="math notranslate nohighlight">\(k\)</span> in <span class="math notranslate nohighlight">\(\vec{r^k}\)</span> gives the number of cycles across all <span class="math notranslate nohighlight">\(N\)</span> values of
<span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<p>For example, consider the case of <span class="math notranslate nohighlight">\(k = 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\vec{r^1} = \left[ 2 \pi \frac{0}{N}, 2 \pi \frac{1}{N},
\ldots 2 \pi \frac{N-1}{N} \right]\]</div>
<p>Here are the values in Python:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_r_1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">vec_n</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_r_1</span>
<span class="go">array([ 0.    ,  0.1963,  0.3927,  0.589 ,  0.7854,  0.9817,  1.1781,</span>
<span class="go">        1.3744,  1.5708,  1.7671,  1.9635,  2.1598,  2.3562,  2.5525,</span>
<span class="go">        2.7489,  2.9452,  3.1416,  3.3379,  3.5343,  3.7306,  3.927 ,</span>
<span class="go">        4.1233,  4.3197,  4.516 ,  4.7124,  4.9087,  5.1051,  5.3014,</span>
<span class="go">        5.4978,  5.6941,  5.8905,  6.0868])</span>
</pre></div>
</div>
<p>The values <span class="math notranslate nohighlight">\(\frac{0}{N}, \frac{1}{N}, \ldots \frac{N-1}{N}\)</span> are fractions of
the number of samples <span class="math notranslate nohighlight">\(N\)</span>, running from 0 to close to 1.  Now multiplied by <span class="math notranslate nohighlight">\(2
\pi\)</span>, the values run from 0 to close to <span class="math notranslate nohighlight">\(2 \pi\)</span> and therefore give angles
around a circle.</p>
<p>The vector <span class="math notranslate nohighlight">\(\vec{r^1}\)</span> gives <span class="math notranslate nohighlight">\(\vec{c^1}, \vec{s^1}\)</span> with a single cycle:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_c_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">vec_r_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_s_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">vec_r_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vec_n</span><span class="p">,</span> <span class="n">vec_c_1</span><span class="p">,</span> <span class="s1">&#39;o:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\vec{c^1}$&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vec_n</span><span class="p">,</span> <span class="n">vec_s_1</span><span class="p">,</span> <span class="s1">&#39;x:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\vec{s^1}$&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Vector index $n$&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$c^1_n$&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei-8.png">png</a>, <a class="reference external" href=".//fourier_no_ei-8.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei-8.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei-8.png" src="_images/fourier_no_ei-8.png" />
</figure>
<p><span class="math notranslate nohighlight">\(k = 2\)</span> gives 2 cycles across the N values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_r_2</span> <span class="o">=</span> <span class="n">vec_r_1</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_c_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">vec_r_2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_s_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">vec_r_2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vec_n</span><span class="p">,</span> <span class="n">vec_c_2</span><span class="p">,</span> <span class="s1">&#39;o:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\vec{c^2}$&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vec_n</span><span class="p">,</span> <span class="n">vec_s_2</span><span class="p">,</span> <span class="s1">&#39;x:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\vec{s^2}$&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Vector index $n$&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$c^2_n$&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei-9.png">png</a>, <a class="reference external" href=".//fourier_no_ei-9.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei-9.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei-9.png" src="_images/fourier_no_ei-9.png" />
</figure>
</section>
</section>
<section id="calculating-the-dft-with-vectors">
<h2>Calculating the DFT with vectors<a class="headerlink" href="#calculating-the-dft-with-vectors" title="Link to this heading">¶</a></h2>
<section id="first-dft-output-value-is-the-vector-sum">
<h3>First DFT output value is the vector sum<a class="headerlink" href="#first-dft-output-value-is-the-vector-sum" title="Link to this heading">¶</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(\vec{r^0}, \vec{c^0}, \vec{s^0}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{r^0} = \left[
0 2 \pi \frac{0}{N}, 0 2 \pi \frac{1}{N}, \ldots
\right] \\
= \left[ 0, 0, \ldots \right] = \vec{0} \\
\vec{c^0} = \left[ 1, 1, \ldots \right] = \vec{1} \\
\vec{s^0} = \left[ 0, 0, \ldots \right] = \vec{0}\end{split}\]</div>
<p>Therefore:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_0 = \vec{x} \cdot \vec{1} - i \vec{x} \cdot \vec{0} \\
= \Sigma x_n\end{split}\]</div>
<p>The first value in the DFT output vector is the sum of the values in
<span class="math notranslate nohighlight">\(\vec{x}\)</span>. If <span class="math notranslate nohighlight">\(\vec{x}\)</span> has real and not complex values, as here, then <span class="math notranslate nohighlight">\(X_0\)</span>
has zero imaginary part:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">-4.3939</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(-4.3939+0j)</span>
</pre></div>
</div>
<p>Now let’s imagine that our input vector is a constant, say a vector of ones.
What is the DFT?</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_ones</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">vec_ones</span><span class="p">)</span>
<span class="go">array([ 32.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j])</span>
</pre></div>
</div>
<p>We were expecting the first value of 32, because it is the sum of 32 values of
one.  All the other values are 0.  This is because all of <span class="math notranslate nohighlight">\(\vec{c^1},
\vec{c^2}, \ldots, \vec{c^{N-1}}\)</span> and all of <span class="math notranslate nohighlight">\(\vec{s^1}, \vec{s^2}, \ldots,
\vec{s^{N-1}}\)</span> sum to zero, and therefore the dot product of all these vectors
with a constant vector is also zero.</p>
</section>
<section id="second-dft-output-corresponds-to-a-sinusoid-at-frequency-1-n">
<h3>Second DFT output corresponds to a sinusoid at frequency <span class="math notranslate nohighlight">\(1 / N\)</span>.<a class="headerlink" href="#second-dft-output-corresponds-to-a-sinusoid-at-frequency-1-n" title="Link to this heading">¶</a></h3>
<p>We have already seen <span class="math notranslate nohighlight">\(\vec{r^1}, \vec{c^1}, \vec{s^1}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\vec{c^1}, \vec{s^1}\)</span> are the cosine, sine at frequency 1 / N where one unit
is the distance between two consecutive samples in <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<div class="math notranslate nohighlight">
\[X_1 = \vec{x} \cdot \vec{c^1} - i \vec{x} \cdot \vec{s^1}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec_c_1</span><span class="p">),</span> <span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">vec_s_1</span><span class="p">))</span>
<span class="go">9.02170725475 3.70356074953</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(9.02170725475-3.70356074953j)</span>
</pre></div>
</div>
<p>This confirms our calculation gives the same result as numpy’s DFT, but isn’t
very revealing.</p>
<p>Let’s make another input vector <span class="math notranslate nohighlight">\(\vec{v}\)</span> that is a cosine at the same
frequency as <span class="math notranslate nohighlight">\(\vec{c^1}\)</span>.  Start with <span class="math notranslate nohighlight">\(\vec{v} = \vec{c^1}\)</span>.</p>
<p>Our prediction for the DFT of <span class="math notranslate nohighlight">\(\vec{v}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V_1 = \vec{v} \cdot \vec{c^1} - i \vec{v} \cdot \vec{s^1} \\
= \vec{c^1} \cdot \vec{c^1} - i \vec{c^1} \cdot \vec{s^1}\end{split}\]</div>
<p>In fact, as you can see in <a class="reference internal" href="fourier_basis.html"><span class="doc">The Fourier basis</span></a>, it is a property of the
<span class="math notranslate nohighlight">\(\vec{c^k}, \vec{s^k}\)</span> vectors that, for all <span class="math notranslate nohighlight">\(k, N\)</span>:</p>
<div class="math notranslate nohighlight">
\[\vec{c^k} \cdot \vec{s^k} = 0\]</div>
<p>Remember from <a class="reference internal" href="on_vectors.html#vector-length"><span class="std std-ref">Vector length</span></a> that, for any vector <span class="math notranslate nohighlight">\(\vec{w}\)</span>, we can
write <span class="math notranslate nohighlight">\(\vec{w} \cdot \vec{w}\)</span> as <span class="math notranslate nohighlight">\(\VL{w}^2\)</span></p>
<p>So:</p>
<div class="math notranslate nohighlight">
\[V_1 = \VL{c^1}^2\]</div>
<p><a class="reference internal" href="fourier_basis.html"><span class="doc">The Fourier basis</span></a> also shows that <span class="math notranslate nohighlight">\(\VL{c_1}^2 = N / 2\)</span> for all N.  More
generally <span class="math notranslate nohighlight">\(\VL{c_p}^2 = \VL{s_p}^2 = N / 2\)</span> for all <span class="math notranslate nohighlight">\(p \notin {0, N/2}\)</span>.</p>
<p>So:</p>
<div class="math notranslate nohighlight">
\[V_1 = N / 2\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vec_v</span> <span class="o">=</span> <span class="n">vec_c_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">vec_v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span>
<span class="go">array([ -0.+0.j,  16.-0.j,   0.+0.j,   0.+0.j,  -0.-0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.-0.j,   0.+0.j,  -0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,  -0.+0.j,   0.-0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,  -0.+0.j,   0.-0.j,  -0.+0.j,  -0.-0.j,  -0.+0.j,</span>
<span class="go">         0.+0.j,  -0.+0.j,   0.-0.j,  -0.+0.j,  -0.+0.j,  -0.+0.j,</span>
<span class="go">         0.-0.j,  16.-0.j])</span>
</pre></div>
</div>
<p>Notice that <span class="math notranslate nohighlight">\(V_{N-1} = N/2 = V_1\)</span>.  This is the property of <em>conjugate
symmetry</em>.   It is so because of the properties of the vectors <span class="math notranslate nohighlight">\(\vec{c^k}\)</span>.
As you see in <a class="reference internal" href="fourier_basis.html"><span class="doc">The Fourier basis</span></a> <span class="math notranslate nohighlight">\(\vec{c_1} = \vec{c_{N-1}}\)</span>, and, more
generally <span class="math notranslate nohighlight">\(\vec{c_p} = \vec{c_{N-p}}\)</span> for <span class="math notranslate nohighlight">\(p \in 1, 2 \ldots, N / 2\)</span>.</p>
<section id="adding-a-scaling-factor-to-the-cosine">
<h4>Adding a scaling factor to the cosine<a class="headerlink" href="#adding-a-scaling-factor-to-the-cosine" title="Link to this heading">¶</a></h4>
<p>Now set <span class="math notranslate nohighlight">\(\vec{v} = a \vec{c^1}\)</span> where <span class="math notranslate nohighlight">\(a\)</span> is a constant:</p>
<div class="math notranslate nohighlight">
\[V_1 = \vec{c^1} \cdot a \vec{c^1} - i \vec{c^1} \cdot a \vec{s^1}\]</div>
<p>By the <a class="reference internal" href="on_vectors.html#dot-product-properties"><span class="std std-ref">properties of the dot product</span></a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V_1 = a \vec{c^1} \cdot \vec{c^1} - i a \vec{c^1} \cdot \vec{s^1} \\
= a \VL{c^1}^2\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_v</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">vec_c_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">vec_v</span><span class="p">)</span>
<span class="go">array([ -0.+0.j,  48.-0.j,   0.+0.j,   0.+0.j,  -0.-0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.-0.j,   0.+0.j,  -0.-0.j,   0.+0.j,</span>
<span class="go">        -0.+0.j,  -0.+0.j,   0.-0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,  -0.+0.j,  -0.-0.j,  -0.+0.j,  -0.+0.j,  -0.+0.j,</span>
<span class="go">         0.+0.j,  -0.+0.j,   0.-0.j,  -0.+0.j,  -0.+0.j,  -0.+0.j,</span>
<span class="go">         0.-0.j,  48.-0.j])</span>
</pre></div>
</div>
</section>
<section id="adding-a-phase-shift-brings-the-sine-into-play">
<h4>Adding a phase shift brings the sine into play<a class="headerlink" href="#adding-a-phase-shift-brings-the-sine-into-play" title="Link to this heading">¶</a></h4>
<p>What happens if we add a phase shift of <span class="math notranslate nohighlight">\(\beta\)</span> radians to the input cosine?</p>
<div class="math notranslate nohighlight">
\[\vec{v} = \left [\cos(r^1_0 + \beta), \cos(r^1_1 + \beta), \ldots,
\cos(r^1_{N-1} + \beta) \right]\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">vec_r_1</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vec_n</span><span class="p">,</span> <span class="n">vec_c_1</span><span class="p">,</span> <span class="s1">&#39;o:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unshifted cos&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vec_n</span><span class="p">,</span> <span class="n">vec_v</span><span class="p">,</span> <span class="s1">&#39;x:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Shifted cos&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei-15.png">png</a>, <a class="reference external" href=".//fourier_no_ei-15.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei-15.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei-15.png" src="_images/fourier_no_ei-15.png" />
</figure>
<p>We can rewrite the shifted cosine using the <a class="reference internal" href="angle_sum.html"><span class="doc">The angle sum rule</span></a>:</p>
<div class="math notranslate nohighlight">
\[\cos(\alpha + \beta) = \cos \alpha \cos \beta - \sin \alpha \sin \beta\]</div>
<p>So:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{v} = \left [\cos(r^1_0 + \beta), \cos(r^1_1 + \beta), \ldots,
\cos(r^1_{N-1} + \beta) \right] \\
= \left [
\cos(r^1_0) \cos(\beta) - \sin(r^1_0) \sin(\beta),
\cos(r^1_1) \cos(\beta) - \sin(r^1_1) \sin(\beta),
\ldots,
\cos(r^1_{N-1}) \cos(\beta) - \sin(r^1_{N-1}) \sin(\beta)
\right] \\
= \cos(\beta) \vec{c^1} - \sin(\beta) \vec{s^1}\end{split}\]</div>
<p>Now apply the vector dot products to get <span class="math notranslate nohighlight">\(V_1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V_1 = (\cos(\beta) \vec{c^1} - \sin(\beta) \vec{s^1}) \cdot \vec{c^1} -
i (\cos(\beta) \vec{c^1} - \sin(\beta) \vec{s^1}) \cdot \vec{s^1} \\
= \cos(\beta) \VL{c^1}^2 + i \sin(\beta) \VL{s^1}^2\end{split}\]</div>
<p>Do we get this answer from the DFT?</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span>
<span class="go">7.25753794281 14.259317761</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">vec_v</span><span class="p">)</span>
<span class="go">array([-0.0000 +0.j    ,  7.2575+14.2593j,  0.0000 +0.j    ,</span>
<span class="go">        0.0000 +0.j    ,  0.0000 +0.j    ,  0.0000 +0.j    ,</span>
<span class="go">       -0.0000 +0.j    ,  0.0000 -0.j    , -0.0000 -0.j    ,</span>
<span class="go">       -0.0000 +0.j    , -0.0000 -0.j    ,  0.0000 +0.j    ,</span>
<span class="go">       -0.0000 +0.j    ,  0.0000 -0.j    ,  0.0000 +0.j    ,</span>
<span class="go">        0.0000 +0.j    , -0.0000 +0.j    ,  0.0000 +0.j    ,</span>
<span class="go">        0.0000 -0.j    ,  0.0000 +0.j    , -0.0000 -0.j    ,</span>
<span class="go">        0.0000 +0.j    , -0.0000 +0.j    ,  0.0000 +0.j    ,</span>
<span class="go">       -0.0000 +0.j    , -0.0000 +0.j    , -0.0000 -0.j    ,</span>
<span class="go">       -0.0000 +0.j    ,  0.0000 -0.j    , -0.0000 +0.j    ,</span>
<span class="go">        0.0000 -0.j    ,  7.2575-14.2593j])</span>
</pre></div>
</div>
<p>Notice that <span class="math notranslate nohighlight">\(V_{N-1}\)</span> has the same value as <span class="math notranslate nohighlight">\(V_{1}\)</span>, but with the imaginary
part flipped in sign.  This is the <em>conjugate</em> in <em>conjugate symmetry</em>.  It
comes about because of the construction of the vectors <span class="math notranslate nohighlight">\(\vec{s^k}\)</span>.  As you
see in <a class="reference internal" href="fourier_basis.html"><span class="doc">The Fourier basis</span></a> <span class="math notranslate nohighlight">\(\vec{s_1} = -\vec{s_{N-1}}\)</span>, and, more generally
<span class="math notranslate nohighlight">\(\vec{s_p} = -\vec{s_{N-p}}\)</span> for <span class="math notranslate nohighlight">\(p \in 1, 2 \ldots, N / 2\)</span>.</p>
</section>
<section id="reconstructing-amplitude-and-phase-from-the-dft">
<h4>Reconstructing amplitude and phase from the DFT<a class="headerlink" href="#reconstructing-amplitude-and-phase-from-the-dft" title="Link to this heading">¶</a></h4>
<p>To complete our journey into <span class="math notranslate nohighlight">\(X_1\)</span>, let us add a scaling <span class="math notranslate nohighlight">\(a\)</span> to the
phase-shifted cosine:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{v} = \left [a \cos(r^1_0 + \beta), a \cos(r^1_1 + \beta), \ldots,
a \cos(r^1_{N-1} + \beta) \right] \\
= \left [
a (\cos(r^1_0) \cos(\beta) - \sin(r^1_0) \sin(\beta)),
a (\cos(r^1_1) \cos(\beta) - \sin(r^1_1) \sin(\beta)),
\ldots,
a (\cos(r^1_{N-1}) \cos(\beta) - \sin(r^1_{N-1}) \sin(\beta))
\right] \\
= a (\cos(\beta) \vec{c^1} - \sin(\beta) \vec{s^1})\end{split}\]</div>
<p>This gives us:</p>
<div class="math notranslate nohighlight" id="equation-scale-and-offset">
<span class="eqno">(4)<a class="headerlink" href="#equation-scale-and-offset" title="Link to this equation">¶</a></span>\[\begin{split}V_1 = a ( \cos(\beta) \vec{c^1} - \sin(\beta) \vec{s^1}) \cdot \vec{c^1} -
i a (\cos(\beta) \vec{c^1} - \sin(\beta) \vec{s^1}) \cdot \vec{s^1} \\
= a \cos(\beta) \VL{c^1}^2 + i a \sin(\beta) \VL{s^1}^2\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">),</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span>
<span class="go">21.7726138284 42.7779532829</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vec_v</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">vec_r_1</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">vec_v</span><span class="p">)</span>
<span class="go">array([ -0.0000 +0.j   ,  21.7726+42.778j,   0.0000 +0.j   ,</span>
<span class="go">         0.0000 +0.j   ,   0.0000 +0.j   ,   0.0000 +0.j   ,</span>
<span class="go">        -0.0000 +0.j   ,   0.0000 -0.j   ,  -0.0000 -0.j   ,</span>
<span class="go">        -0.0000 +0.j   ,  -0.0000 -0.j   ,   0.0000 +0.j   ,</span>
<span class="go">        -0.0000 +0.j   ,   0.0000 -0.j   ,   0.0000 +0.j   ,</span>
<span class="go">         0.0000 +0.j   ,  -0.0000 +0.j   ,   0.0000 +0.j   ,</span>
<span class="go">         0.0000 -0.j   ,   0.0000 +0.j   ,  -0.0000 -0.j   ,</span>
<span class="go">         0.0000 +0.j   ,  -0.0000 +0.j   ,   0.0000 +0.j   ,</span>
<span class="go">        -0.0000 +0.j   ,  -0.0000 +0.j   ,  -0.0000 -0.j   ,</span>
<span class="go">        -0.0000 +0.j   ,   0.0000 -0.j   ,  -0.0000 +0.j   ,</span>
<span class="go">         0.0000 -0.j   ,  21.7726-42.778j])</span>
</pre></div>
</div>
<p>What if I want to reconstruct <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> from the DFT coefficients?</p>
<p>From <a class="reference internal" href="#equation-scale-and-offset">(4)</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\R{X_1} = a \cos(\beta) N / 2 \\
\I{X_1} = a \sin(\beta) N / 2\end{split}\]</div>
<p>So:</p>
<div class="math notranslate nohighlight">
\[\R{X_1}^2 + \I{X_1}^2 = a^2 N^2/4 (\cos(\beta)^2 + \sin(\beta)^2)\]</div>
<p>By Pythagoras:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\R{X_1}^2 + \I{X_1}^2 = a^2 N^2/4 \implies \\
\sqrt{\R{X_1}^2 + \I{X_1}^2} = a N / 2\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">vec_v</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">47.999999999999993</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">3</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="go">48.0</span>
</pre></div>
</div>
<p>We can get the angle <span class="math notranslate nohighlight">\(\beta\)</span> in a similar way:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\R{X_1} = a \cos(\beta) N / 2 \implies \\
\cos(\beta) = \R{X_1} / (a N / 2)\end{split}\]</div>
<p><code class="docutils literal notranslate"><span class="pre">np.arccos</span></code> is the inverse of <code class="docutils literal notranslate"><span class="pre">np.cos</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
<span class="go">0.4535961214255782</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
<span class="go">0.45359612142557731</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span>
<span class="go">1.099999999999999</span>
</pre></div>
</div>
<p>In fact, these are the calculations done by the standard <code class="docutils literal notranslate"><span class="pre">np.abs,</span> <span class="pre">np.angle</span></code>
functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span>
<span class="go">47.999999999999993</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">X_1</span><span class="p">)</span>
<span class="go">1.099999999999999</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference download internal" href="fourier_no_ei.py">Download this page as a Python code file</a>;</p></li>
<li><p><a class="reference download internal" href="fourier_no_ei.ipynb">Download this page as a Jupyter notebook (no outputs)</a>.</p></li>
</ul>
</section>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Teaching</a></h1>



<p class="blurb">Teaching</p>







<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="angle_sum.html">The angle sum rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonferroni_correction.html">Notes on the Bonferroni threshold</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlated_regressors.html">Correlated regressors</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdr.html">Thresholding with false discovery rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating_point.html">Points on floats</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating_error.html">Floating point error</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier_basis.html">The Fourier basis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fourier without the ei</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-hard-is-the-mathematics">How hard is the mathematics?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-and-configuring-code-libraries">Loading and configuring code libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-actual-numbers-to-start">Some actual numbers to start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#traditional-notation-for-the-discrete-fourier-transform">Traditional notation for the discrete Fourier transform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dft-and-fft">DFT and FFT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rewriting-the-dft-without-the-e-i">Rewriting the DFT without the <span class="math notranslate nohighlight">\(e^i\)</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-rewrite-without-e-i">Why rewrite without <span class="math notranslate nohighlight">\(e^i\)</span>?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-rewrite-without-e-i">How to rewrite without <span class="math notranslate nohighlight">\(e^i\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewriting-the-dft-with-vectors">Rewriting the DFT with vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frequency-as-cycles-across-the-sample-vector">Frequency as cycles across the sample vector</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#calculating-the-dft-with-vectors">Calculating the DFT with vectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#first-dft-output-value-is-the-vector-sum">First DFT output value is the vector sum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#second-dft-output-corresponds-to-a-sinusoid-at-frequency-1-n">Second DFT output corresponds to a sinusoid at frequency <span class="math notranslate nohighlight">\(1 / N\)</span>.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-a-scaling-factor-to-the-cosine">Adding a scaling factor to the cosine</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-a-phase-shift-brings-the-sine-into-play">Adding a phase shift brings the sine into play</a></li>
<li class="toctree-l4"><a class="reference internal" href="#reconstructing-amplitude-and-phase-from-the-dft">Reconstructing amplitude and phase from the DFT</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fourier_no_ei_orig.html">Fourier without the ei</a></li>
<li class="toctree-l1"><a class="reference internal" href="glm_intro.html">Introduction to the general linear model</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html">The argument in “Why most published research findings are false”</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#the-practice-of-science-is-profoundly-broken-discuss-no-model-and-test">“The practice of science is profoundly broken”. Discuss? - no - model and test!</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#different-ways-of-phrasing-the-argument">Different ways of phrasing the argument</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#some-terms">Some terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#what-does-a-significant-statistical-test-result-tell-us">What does a “significant” statistical test result tell us?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#what-is-a-finding-that-is-likely-to-be-true">What is a finding that is likely to be true?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#whether-a-finding-is-likely-to-be-true-depends-on-the-power-of-the-experiment">Whether a finding is likely to be true depends on the power of the experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#quantifying-the-effect-of-bias">Quantifying the effect of bias</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#the-effect-of-multiple-studies">The effect of multiple studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#putting-it-together">Putting it together</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutual_information.html">Mutual information as an image matching metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="notation.html">Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizing_space.html">Calculating transformations between images</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_convolution.html">Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_vectors.html">Vectors and dot products</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca_introduction.html">Introducing principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_complex.html">Refresher on complex numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="slice_timing.html">Slice timing correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoothing_intro.html">An introduction to smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoothing_as_convolution.html">Smoothing as convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="some_sums.html">Some algebra with summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sums_of_cosines.html">Sum of sines and cosines</a></li>
<li class="toctree-l1"><a class="reference internal" href="sums_of_sinusoids.html">Sums of sinusoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_fields.html">Thresholding with random field theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Teaching repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation_2d.html">Formula for rotating a vector in 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_projection.html">Vector projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_angles.html">Angles between vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlation_projection.html">Correlation and projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_rank.html">Matrix rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_interpolation.html">Linear interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_cdfs.html">p values from cumulative distribution functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions_are_objects.html">Functions are objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_scope.html">Global and local scope of Python variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="brisk_python.html">Brisk introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="string_formatting.html">Inserting values into strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_loops.html">“for” and “while”, “break” and “else:”</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://matthew.dynevor.org">Home page</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="fourier_basis.html" title="previous chapter">The Fourier basis</a></li>
      <li>Next: <a href="fourier_no_ei_orig.html" title="next chapter">Fourier without the ei</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2016, Matthew Brett.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/fourier_no_ei.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>