<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Fourier without the ei &#8212; Tutorials on imaging, computing and mathematics</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/copybutton.js?v=fc45e087"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to the general linear model" href="glm_intro.html" />
    <link rel="prev" title="Fourier without the ei" href="fourier_no_ei.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p><span class="math notranslate nohighlight">\(\newcommand{L}[1]{\| #1 \|}\newcommand{VL}[1]{\L{ \vec{#1} }}\newcommand{R}[1]{\operatorname{Re}\,(#1)}\newcommand{I}[1]{\operatorname{Im}\, (#1)}\)</span></p>
<section id="fourier-without-the-ei">
<h1>Fourier without the ei<a class="headerlink" href="#fourier-without-the-ei" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The standard equations for discrete Fourier transforms (DFTs) involve
exponentials to the power of <span class="math notranslate nohighlight">\(i\)</span> - the imaginary unit. I
personally find these difficult to think about, and it turns out, the
DFT is fairly easy to recast in terms of <span class="math notranslate nohighlight">\(\sin\)</span> and <span class="math notranslate nohighlight">\(\cos\)</span>.
This page goes through this process, and tries to show how thinking in
this way can explain some features of the DFT.</p>
<section id="how-hard-is-the-mathematics">
<h3>How hard is the mathematics?<a class="headerlink" href="#how-hard-is-the-mathematics" title="Link to this heading">¶</a></h3>
<p>You will not need heavy math to follow this page. If you don’t remember
the following concepts you might want to brush up on them. There are
also links to proofs and explanations for these ideas in the page as we
go along:</p>
<ul class="simple">
<li><p>basic trigonometry (SOH CAH TOA, Pythagoras’ theorem);</p></li>
<li><p>the <a class="reference internal" href="angle_sum.html"><span class="doc">angle sum rule</span></a>;</p></li>
<li><p><a class="reference internal" href="some_sums.html"><span class="doc">basic algebra with sums</span></a>;</p></li>
<li><p><a class="reference internal" href="on_vectors.html"><span class="doc">Vectors and dot products</span></a>;</p></li>
<li><p>vector projection using the dot product.</p></li>
</ul>
<p>You will not need to understand complex numbers in any depth, but see
<a class="reference internal" href="simple_complex.html"><span class="doc">Refresher on complex numbers</span></a>.</p>
</section>
<section id="loading-and-configuring-code-libraries">
<h3>Loading and configuring code libraries<a class="headerlink" href="#loading-and-configuring-code-libraries" title="Link to this heading">¶</a></h3>
<p>Load and configure the Python libraries we will use:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># - import common modules</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># the Python array package</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># the Python plotting package</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># - tell numpy to print numbers to 4 decimal places only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># - function to print non-numpy scalars to 4 decimal places</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">to_4dp</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If running in the IPython console, consider running <code class="docutils literal notranslate"><span class="pre">%matplotlib</span></code> to enable
interactive plots.  If running in the Jupyter Notebook, use <code class="docutils literal notranslate"><span class="pre">%matplotlib</span>
<span class="pre">inline</span></code>.</p>
</div>
</section>
</section>
<section id="some-actual-numbers-to-start">
<h2>Some actual numbers to start<a class="headerlink" href="#some-actual-numbers-to-start" title="Link to this heading">¶</a></h2>
<p>Let us start with a DFT of some data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># An example input vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span> <span class="mf">0.4967</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1383</span><span class="p">,</span>  <span class="mf">0.6477</span><span class="p">,</span>  <span class="mf">1.523</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.2342</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2341</span><span class="p">,</span>  <span class="mf">1.5792</span><span class="p">,</span>
<span class="gp">... </span>      <span class="mf">0.7674</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4695</span><span class="p">,</span>  <span class="mf">0.5426</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4634</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4657</span><span class="p">,</span>  <span class="mf">0.242</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.9133</span><span class="p">,</span>
<span class="gp">... </span>     <span class="o">-</span><span class="mf">1.7249</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5623</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0128</span><span class="p">,</span>  <span class="mf">0.3142</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.908</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.4123</span><span class="p">,</span>  <span class="mf">1.4656</span><span class="p">,</span>
<span class="gp">... </span>     <span class="o">-</span><span class="mf">0.2258</span><span class="p">,</span>  <span class="mf">0.0675</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4247</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5444</span><span class="p">,</span>  <span class="mf">0.1109</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.151</span> <span class="p">,</span>  <span class="mf">0.3757</span><span class="p">,</span>
<span class="gp">... </span>     <span class="o">-</span><span class="mf">0.6006</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2917</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6017</span><span class="p">,</span>  <span class="mf">1.8523</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>  <span class="c1"># the length of the time-series</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-3.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-3.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-3.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-3.png" src="_images/fourier_no_ei_orig-3.png" />
</figure>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now the DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span>
<span class="go">array([-4.3939+0.j    ,  9.0217-3.7036j, -0.5874-6.2268j,  2.5184+3.7749j,</span>
<span class="go">        0.5008-0.8433j,  1.2904-0.4024j,  4.3391+0.8079j, -6.2614+2.1596j,</span>
<span class="go">        1.8974+2.4889j,  0.1042+7.6169j,  0.3606+5.162j ,  4.7965+0.0755j,</span>
<span class="go">       -5.3064-3.2329j,  4.6237+1.5287j, -2.1211+4.4873j, -4.0175-0.3712j,</span>
<span class="go">       -2.0297+0.j    , -4.0175+0.3712j, -2.1211-4.4873j,  4.6237-1.5287j,</span>
<span class="go">       -5.3064+3.2329j,  4.7965-0.0755j,  0.3606-5.162j ,  0.1042-7.6169j,</span>
<span class="go">        1.8974-2.4889j, -6.2614-2.1596j,  4.3391-0.8079j,  1.2904+0.4024j,</span>
<span class="go">        0.5008+0.8433j,  2.5184-3.7749j, -0.5874+6.2268j,  9.0217+3.7036j])</span>
</pre></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">X</span></code> - the output of the forward DFT - is a vector of
complex numbers. We will go into this in detail later.</p>
<p>When we do the inverse DFT on <code class="docutils literal notranslate"><span class="pre">X</span></code> we return the original values of our
input <code class="docutils literal notranslate"><span class="pre">x</span></code>, but as complex numbers with imaginary part 0:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the inverse DFT to the output of the forward DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_back</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_back</span>
<span class="go">array([ 0.4967-0.j, -0.1383-0.j,  0.6477-0.j,  1.5230-0.j, -0.2342-0.j,</span>
<span class="go">       -0.2341+0.j,  1.5792+0.j,  0.7674+0.j, -0.4695-0.j,  0.5426-0.j,</span>
<span class="go">       -0.4634-0.j, -0.4657+0.j,  0.2420-0.j, -1.9133-0.j, -1.7249-0.j,</span>
<span class="go">       -0.5623+0.j, -1.0128-0.j,  0.3142+0.j, -0.9080+0.j, -1.4123+0.j,</span>
<span class="go">        1.4656+0.j, -0.2258+0.j,  0.0675+0.j, -1.4247-0.j, -0.5444+0.j,</span>
<span class="go">        0.1109+0.j, -1.1510+0.j,  0.3757-0.j, -0.6006-0.j, -0.2917-0.j,</span>
<span class="go">       -0.6017-0.j,  1.8523-0.j])</span>
</pre></div>
</div>
</section>
<section id="rewriting-the-dft-without-the-e-i">
<h2>Rewriting the DFT without the <span class="math notranslate nohighlight">\(e^i\)</span><a class="headerlink" href="#rewriting-the-dft-without-the-e-i" title="Link to this heading">¶</a></h2>
<section id="dft-and-fft">
<h3>DFT and FFT<a class="headerlink" href="#dft-and-fft" title="Link to this heading">¶</a></h3>
<p>The fast fourier transform (FFT) refers to a particular set of - er -
fast algorithms for calculating the DFT. It is common, but confusing, to
use “FFT” to mean DFT.</p>
</section>
<section id="introducing-the-discrete-fourier-transform">
<h3>Introducing the discrete Fourier transform<a class="headerlink" href="#introducing-the-discrete-fourier-transform" title="Link to this heading">¶</a></h3>
<p>Let us say we have a vector of <span class="math notranslate nohighlight">\(N\)</span> values in time, or space
<span class="math notranslate nohighlight">\(\vec{x} = [x_0, x_1 ... x_{N-1}]\)</span>. We generally index
<span class="math notranslate nohighlight">\(\vec{x}\)</span> with subscript <span class="math notranslate nohighlight">\(n\)</span>, so the sample at index
<span class="math notranslate nohighlight">\(n\)</span> is <span class="math notranslate nohighlight">\(x_n\)</span>.</p>
<p>The DFT converts <span class="math notranslate nohighlight">\(\vec{x}\)</span> from a vector in time, or space, to a
vector <span class="math notranslate nohighlight">\(\vec{X}\)</span> representing temporal or spatial frequency
components.</p>
<p>We will call our original <span class="math notranslate nohighlight">\(\vec{x}\)</span> the <em>signal</em>, meaning, the
signal not transformed to frequency.</p>
<p>The DFT converts <span class="math notranslate nohighlight">\(\vec{x}\)</span> to <span class="math notranslate nohighlight">\(\vec{X}\)</span> where
<span class="math notranslate nohighlight">\(\vec{X} = [X_0, X_1, ... X_{N-1}]\)</span>. We generally index
<span class="math notranslate nohighlight">\(\vec{X}\)</span> with subscript <span class="math notranslate nohighlight">\(k\)</span>, so the sample at index
<span class="math notranslate nohighlight">\(k\)</span> is <span class="math notranslate nohighlight">\(X_k\)</span>.</p>
<p>Here is the equation for the discrete Fourier transform:</p>
<div class="math notranslate nohighlight">
\[X_k = \sum_{n=0}^{N-1} x_n \; e^{-i 2 \pi \frac{k}{N} n}\]</div>
<p>This is the transform from signal to frequency. We will call this the
<em>forward</em> Fourier transform.</p>
<p>Here is the equation for the inverse Fourier transform:</p>
<div class="math notranslate nohighlight">
\[x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k \; e^{i 2 \pi \frac{k}{N} n}\]</div>
<p>The inverse Fourier transform converts from frequency back to signal.</p>
</section>
<section id="scrubbing-the-e-i">
<h3>Scrubbing the <span class="math notranslate nohighlight">\(e^i\)</span><a class="headerlink" href="#scrubbing-the-e-i" title="Link to this heading">¶</a></h3>
<p>The forward and inverse equations are very similar; both share a term
<span class="math notranslate nohighlight">\(e^{iz}\)</span>, where <span class="math notranslate nohighlight">\(z = -2 \pi \frac{k}{N} n\)</span> for the forward
transform; <span class="math notranslate nohighlight">\(z = 2 \pi \frac{k}{N} n\)</span> for the inverse transform.</p>
<p>Some people are used to looking at the form <span class="math notranslate nohighlight">\(e^{iz}\)</span> and thinking
“aha, that’s a rotation around a circle”. Apparently this is an
intuition that builds up over time working with these sorts of
equations.</p>
<p>Unfortunately, some of us find it hard to think in complex exponentials,
or in terms of complex numbers.</p>
<p>So, in this tutorial, we will express the Fourier transform in terms of
<span class="math notranslate nohighlight">\(\sin\)</span> and <span class="math notranslate nohighlight">\(\cos\)</span>. We will be using complex numbers, but
almost entirely as a pair of numbers to represent two components of the
same thing, rather than a single number with a real and imaginary part.</p>
<p>Having said that, we will need some very basic properties of complex and
imaginary numbers - see <a class="reference internal" href="simple_complex.html"><span class="doc">Refresher on complex numbers</span></a>.</p>
</section>
<section id="back-to-scrubbing-the-e-i">
<h3>Back to scrubbing the <span class="math notranslate nohighlight">\(e^i\)</span><a class="headerlink" href="#back-to-scrubbing-the-e-i" title="Link to this heading">¶</a></h3>
<p>Our first tool in this enterprise is Euler’s formula:</p>
<div class="math notranslate nohighlight">
\[e^{ix} = \cos x + i\sin x\]</div>
<p>This is the basis for thinking of <span class="math notranslate nohighlight">\(e^{ix}\)</span> as being rotation
around a circle, of which you will hear no more in this page. In our
case, it allows us to rewrite the forward and inverse Fourier
transforms:</p>
<p>First let’s define a new value <span class="math notranslate nohighlight">\(D\)</span>, that depends on <span class="math notranslate nohighlight">\(N\)</span> -
the number of observations in our vector <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<div class="math notranslate nohighlight">
\[D \triangleq \frac{2 \pi}{N}\]</div>
<p>With that value:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_k = \sum_{n=0}^{N-1} x_n \cdot \cos(-k n D) + i \sum_{n=0}^{N-1} x_n \cdot
\sin(-k n D) \\
x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k \cdot \cos(k n D) + i \frac{1}{N}
\sum_{k=0}^{N-1} X_k \cdot \sin(k n D)\end{split}\]</div>
<p>We can simplify this a bit further, because, for any angle <span class="math notranslate nohighlight">\(\alpha\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\cos(-\alpha) = cos(\alpha) \\
\sin(-\alpha) = -sin(\alpha)\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}X_k = \sum_{n=0}^{N-1} x_n \cdot \cos(k n D) - i \sum_{n=0}^{N-1} x_n \cdot
\sin(k n D)
\\
x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k \cdot \cos(k n D) + i \frac{1}{N}
\sum_{k=0}^{N-1} X_k \cdot \sin(k n D)\end{split}\]</div>
</section>
<section id="rewriting-as-dot-products">
<h3>Rewriting as dot products<a class="headerlink" href="#rewriting-as-dot-products" title="Link to this heading">¶</a></h3>
<p>We can simplify the notation, and maybe make the process clearer, by
rewriting these sums in terms of dot products.</p>
<p>As y’all remember, the dot product of two length <span class="math notranslate nohighlight">\(N\)</span> vectors
<span class="math notranslate nohighlight">\(\vec{v}, \vec{w}\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[\vec{v} \cdot \vec{w} \triangleq \sum_{i=0}^{N-1} v_i w_i\]</div>
<p>Clearly, because <span class="math notranslate nohighlight">\(v_i w_i = w_i v_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[\vec{v} \cdot \vec{w} = \vec{w} \cdot \vec{v}\]</div>
<p>For the moment, let us concentrate on the forward transform.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{t_k} \triangleq \left[ k 2 \pi \frac{n}{N} \;\mathrm{for}\; n \in
0,1,\ldots,N-1 \right] \\
\vec{c_k} \triangleq \left[ \cos(t_{k,n}) \;\mathrm{for}\; n \in 0,1,\ldots,N-1
\right] \\
\vec{s_k} \triangleq \left[ \sin(t_{k,n}) \;\mathrm{for}\; n \in 0,1,\ldots,N-1
\right]\end{split}\]</div>
<p>Now we can rewrite the sums in the forward transform as the sum of two
dot products:</p>
<div class="math notranslate nohighlight">
\[X_k = \vec{x} \cdot \vec{c_k} - i \vec{x} \cdot \vec{s_k}\]</div>
<p>The vector <span class="math notranslate nohighlight">\(\vec{t_k}\)</span> is key to understanding what is going on.
<span class="math notranslate nohighlight">\(t_k\)</span> sets up the horizontal axis values to sample a <span class="math notranslate nohighlight">\(\sin\)</span>
or <span class="math notranslate nohighlight">\(\cos\)</span> function so the function gives us <span class="math notranslate nohighlight">\(k\)</span> cycles over
the indices <span class="math notranslate nohighlight">\(0 .. N-1\)</span>.</p>
<p>In the formulae above, <span class="math notranslate nohighlight">\(n / N\)</span> is the proportion of the whole
signal width <span class="math notranslate nohighlight">\(N\)</span>, so it varies between 0 and <span class="math notranslate nohighlight">\((N-1) / N\)</span>.
The <span class="math notranslate nohighlight">\(2 \pi\)</span> corresponds to one cycle of the cosine or sine
function.</p>
<p>So, <span class="math notranslate nohighlight">\(\vec{t_0}\)</span> gives a vector of zeros corresponding to
<span class="math notranslate nohighlight">\(k=0\)</span> cycles across <span class="math notranslate nohighlight">\(0 ... N-1\)</span>. <span class="math notranslate nohighlight">\(\vec{t_1}\)</span> gives us
<span class="math notranslate nohighlight">\(0\)</span> up to (not including) <span class="math notranslate nohighlight">\(2 \pi\)</span> - one cycle across the
indices <span class="math notranslate nohighlight">\(0 .. N-1\)</span>. <span class="math notranslate nohighlight">\(\vec{t_2}\)</span> gives us <span class="math notranslate nohighlight">\(0\)</span> up to
(not including) <span class="math notranslate nohighlight">\(4 \pi\)</span> - two cycles.</p>
<p>Here are some plots of <span class="math notranslate nohighlight">\(\vec{c_k}\)</span>, <span class="math notranslate nohighlight">\(\vec{s_k}\)</span> for
<span class="math notranslate nohighlight">\(k \in 0, 1, 2, 3, 4, 5\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">one_cycle</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ns</span> <span class="o">/</span> <span class="n">N</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">t_k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">one_cycle</span>
<span class="gp">... </span>    <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t_k</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t_k</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="go">[...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-6.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-6.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-6.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-6.png" src="_images/fourier_no_ei_orig-6.png" />
</figure>
<p>To rephrase: <span class="math notranslate nohighlight">\(\vec{c_k}, \vec{s_k}\)</span> are cosine / sine waves with
<span class="math notranslate nohighlight">\(k\)</span> cycles over the <span class="math notranslate nohighlight">\(N\)</span> indices.</p>
<p>So, the <span class="math notranslate nohighlight">\(X_k\)</span> value is the dot product of the <span class="math notranslate nohighlight">\(\vec{x}\)</span> with
a cosine wave of <span class="math notranslate nohighlight">\(k\)</span> cycles minus <span class="math notranslate nohighlight">\(i\)</span> times the dot product
of <span class="math notranslate nohighlight">\(\vec{x}\)</span> with the sine wave of <span class="math notranslate nohighlight">\(k\)</span> cycles.</p>
<p>While this is all fresh in our minds, let us fill out the equivalent
notation for the inverse transform.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{t_n} \triangleq \left[ n 2 \pi \frac{k}{N} \;\mathrm{for}\; k \in
=0,1,\ldots,N-1 \right] \\
\vec{c_n} \triangleq \left[ \cos(t_{n,k}) \;\mathrm{for}\; k \in 0,1,\ldots,N-1
\right] \\
\vec{s_n} \triangleq \left[ \sin(t_{n,k}) \;\mathrm{for}\; k \in 0,1,\ldots,N-1
\right]\end{split}\]</div>
<p>Because both <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(k\)</span> have indices from <span class="math notranslate nohighlight">\(0 .. N-1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{t_k} = \vec{t_n} \;\mathrm{where}\; k=n \\
\vec{c_k} = \vec{c_n} \;\mathrm{where}\; k=n \\
\vec{s_k} = \vec{s_n} \;\mathrm{where}\; k=n\end{split}\]</div>
<p>We will return to this point fairly soon.</p>
<p>The inverse transform is now:</p>
<div class="math notranslate nohighlight">
\[x_n = \frac{1}{N} \vec{X} \cdot \vec{c_n} + i \frac{1}{N} \vec{X} \cdot
\vec{s_n}\]</div>
</section>
<section id="rewriting-the-dft-with-cosine-and-sine-basis-matrices">
<h3>Rewriting the DFT with cosine and sine basis matrices<a class="headerlink" href="#rewriting-the-dft-with-cosine-and-sine-basis-matrices" title="Link to this heading">¶</a></h3>
<p>Instead of writing the formulae for the individual elements <span class="math notranslate nohighlight">\(X_k\)</span>
and <span class="math notranslate nohighlight">\(x_n\)</span>, we can use matrices to express our formulae in terms of
the vectors <span class="math notranslate nohighlight">\(\vec{X}, \vec{x}\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\newcommand{C}{\mathbf{C}} \newcommand{S}{\mathbf{S}}\)</span> Define a
matrix <span class="math notranslate nohighlight">\(\C\)</span> that has rows
<span class="math notranslate nohighlight">\([\vec{c_0}, \vec{c_1}, ..., \vec{c_{N-1}}]\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\C \triangleq
 \begin{bmatrix}
    c_{0,0}, c_{0, 1}, ..., c_{0, N-1} \\
    c_{1,0}, c_{1, 1}, ..., c_{1, N-1} \\
    ... \\
    c_{N-1,0}, c_{N-1, 1}, ..., c_{N-1, N-1} \\
 \end{bmatrix}\end{split}\]</div>
<p>Call <span class="math notranslate nohighlight">\(\C\)</span> the <em>cosine basis matrix</em>.</p>
<p>Define a matrix <span class="math notranslate nohighlight">\(\S\)</span> that has rows
<span class="math notranslate nohighlight">\([\vec{s_0}, \vec{s_1}, ..., \vec{s_{N-1}}]\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\S \triangleq
 \begin{bmatrix}
    s_{0,0}, s_{0, 1}, ..., s_{0, N-1} \\
    s_{1,0}, s_{1, 1}, ..., s_{1, N-1} \\
    ... \\
    s_{N-1,0}, s_{N-1, 1}, ..., s_{N-1, N-1} \\
 \end{bmatrix}\end{split}\]</div>
<p>Call <span class="math notranslate nohighlight">\(\S\)</span> the <em>sine basis matrix</em>.</p>
<p>Now we can rewrite the forward and inverse DFT as matrix products:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{X} = \C \cdot \vec{x} - i \S \cdot \vec{x} \\
\vec{x} = \frac{1}{N} \C \cdot \vec{X} + i \frac{1}{N} \S \cdot \vec{X}\end{split}\]</div>
<p>This gives us the same calculation for <span class="math notranslate nohighlight">\(X_k\)</span> and <span class="math notranslate nohighlight">\(x_n\)</span> as we
have above using the vector dot products. Write row <span class="math notranslate nohighlight">\(k\)</span> of
<span class="math notranslate nohighlight">\(\C\)</span> as <span class="math notranslate nohighlight">\(C_{k,:}\)</span>. Row <span class="math notranslate nohighlight">\(k\)</span> of <span class="math notranslate nohighlight">\(\S\)</span> is
<span class="math notranslate nohighlight">\(S_{k,:}\)</span>. Thus, from the rules of matrix multiplication:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X_k = C_{k,:} \cdot \vec{x} - i S_{k,:} \cdot \vec{x} \\
= \vec{x} \cdot \vec{c_k} - i \vec{x} \cdot \vec{s_k}\end{split}\]</div>
<p>and (inverse transform):</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_n = \frac{1}{N} C_{n,:} \cdot \vec{X} + i \frac{1}{N} S_{n,:} \cdot \vec{X} \\
= \frac{1}{N} \vec{X} \cdot \vec{c_n} + i \frac{1}{N} \vec{X} \cdot \vec{s_n}\end{split}\]</div>
<p>We can build <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> for our case with <span class="math notranslate nohighlight">\(N=32\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">one_cycle</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ns</span> <span class="o">/</span> <span class="n">N</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">t_k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">one_cycle</span>
<span class="gp">... </span>    <span class="n">C</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t_k</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">S</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t_k</span><span class="p">)</span>
</pre></div>
</div>
<p>We get the same result using this matrix formula, as we do using the
canned DFT:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Recalculate the forward transform with C and S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_again</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X_again</span><span class="p">)</span>  <span class="c1"># same result as for np.fft.fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Recalculate the inverse transform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_again</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_again</span><span class="p">)</span>  <span class="c1"># as for np.fft.ifft, we get x back</span>
</pre></div>
</div>
</section>
<section id="displaying-the-dft-transform">
<h3>Displaying the DFT transform<a class="headerlink" href="#displaying-the-dft-transform" title="Link to this heading">¶</a></h3>
<p>We can show the matrix calculation of the DFT as images. To do this we
will use some specialized code. If you are running this tutorial yourself,
download <a class="reference download internal" download="" href="_downloads/ed7419a00057af7563a6e3e6732f1019/dft_plots.py"><code class="xref download docutils literal notranslate"><span class="pre">dft_plots.py</span></code></a> to the directory containing this page.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Import the custom DFT plotting code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dft_plots</span> <span class="k">as</span> <span class="nn">dftp</span>
</pre></div>
</div>
<p>Here we show the forward DFT given by the formula:</p>
<div class="math notranslate nohighlight">
\[\vec{X} = \C \cdot \vec{x} - i \S \cdot \vec{x}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Show image sketch for forward DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">DFTSketch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-10.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-10.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-10.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-10.png" src="_images/fourier_no_ei_orig-10.png" />
</figure>
<p>The plot shows each matrix and vector as grayscale, where mid gray
corresponds to 0, black corresponds to the most negative value and white
to the most positive value. For example the first four values in the
vector <span class="math notranslate nohighlight">\(\vec{x}\)</span> are:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="go">array([ 0.4967, -0.1383,  0.6477,  1.523 ])</span>
</pre></div>
</div>
<p>You can see <span class="math notranslate nohighlight">\(\vec{x}\)</span> shown at the right of the graphic as a
column vector. The grayscale of the top four values in the graphic are
light gray, mid gray, light gray, and near white, corresponding to the
values above.</p>
<p><span class="math notranslate nohighlight">\(\vec{X}\)</span> is a vector of complex numbers.</p>
<p>On the left of the equals sign you see the complex vector
<span class="math notranslate nohighlight">\(\vec{X}\)</span> displayed as two columns.</p>
<p>Define <span class="math notranslate nohighlight">\(\R{\vec{X}}\)</span> to be the vector containing the real parts of
the complex values in <span class="math notranslate nohighlight">\(\vec{X}\)</span>. Define <span class="math notranslate nohighlight">\(\I{\vec{X}}\)</span> to be
the vector containing the imaginary parts of <span class="math notranslate nohighlight">\(\vec{X}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\R{\vec{X}} \triangleq [\R{X_0}, \R{X_1}, ..., \R{X_{N-1}}] \\
\I{\vec{X}} \triangleq [\I{X_0}, \I{X_1}, ..., \I{X_{N-1}}]\end{split}\]</div>
<p>The left hand column in the graphic shows <span class="math notranslate nohighlight">\(\R{\vec{X}}\)</span>, and the
column to the right of that shows <span class="math notranslate nohighlight">\(\I{\vec{X}}\)</span>.</p>
<p>To the right of the equals sign we see the representation of
<span class="math notranslate nohighlight">\(\C \cdot \vec{x}\)</span> and <span class="math notranslate nohighlight">\(\S \cdot \vec{x}\)</span>, with
<span class="math notranslate nohighlight">\(\vec{x}\)</span> displayed as a column vector.</p>
<p><span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> have some interesting patterns which we will
explore in the next section.</p>
<p>We can show the inverse DFT in the same way:</p>
<div class="math notranslate nohighlight">
\[\vec{x} = \frac{1}{N} \C \cdot \vec{X} + i \frac{1}{N} \S \cdot \vec{X}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-12.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-12.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-12.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-12.png" src="_images/fourier_no_ei_orig-12.png" />
</figure>
<p>The output from the inverse transform is a complex vector, but in our
case, where the input to the DFT was a vector of real numbers, the
imaginary parts are all zero, and the real part is equal to our input to
the forward DFT : <span class="math notranslate nohighlight">\(\vec{x}\)</span>. We will see why the imaginary parts
are all zero in the following sections.</p>
</section>
<section id="real-and-complex-input-to-the-dft">
<h3>Real and complex input to the DFT<a class="headerlink" href="#real-and-complex-input-to-the-dft" title="Link to this heading">¶</a></h3>
<p>This page is mostly concerned with the common case where the input to
the forward DFT is a vector of real numbers. The mathematics also works
for the case where the input to the forward DFT is a vector of complex
numbers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">complex_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>  <span class="c1"># A Random array of complex numbers</span>
<span class="gp">... </span>      <span class="p">[</span> <span class="mf">0.61</span><span class="o">-</span><span class="mf">0.83</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.82</span><span class="o">-</span><span class="mf">0.12</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50</span><span class="o">+</span><span class="mf">1.14</span><span class="n">j</span><span class="p">,</span>  <span class="mf">2.37</span><span class="o">+</span><span class="mf">1.67</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.62</span><span class="o">+</span><span class="mf">0.69</span><span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mf">1.61</span><span class="o">-</span><span class="mf">0.06</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.54</span><span class="o">-</span><span class="mf">0.73</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.89</span><span class="o">-</span><span class="mf">1.</span><span class="n">j</span>  <span class="p">,</span>  <span class="mf">0.17</span><span class="o">-</span><span class="mf">0.71</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.75</span><span class="o">-</span><span class="mf">0.01</span><span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>       <span class="o">-</span><span class="mf">1.06</span><span class="o">-</span><span class="mf">0.14</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.53</span><span class="o">-</span><span class="mf">0.33</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.74</span><span class="o">+</span><span class="mf">0.83</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.34</span><span class="o">-</span><span class="mf">0.64</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.47</span><span class="o">+</span><span class="mf">0.71</span><span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mf">0.82</span><span class="o">+</span><span class="mf">0.4</span><span class="n">j</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.59</span><span class="o">-</span><span class="mf">0.58</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.13</span><span class="o">-</span><span class="mf">1.02</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.47</span><span class="o">-</span><span class="mf">0.73</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.45</span><span class="o">+</span><span class="mf">1.31</span><span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mf">1.32</span><span class="o">-</span><span class="mf">0.28</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.58</span><span class="o">-</span><span class="mf">2.13</span><span class="n">j</span><span class="p">,</span>  <span class="mf">0.75</span><span class="o">-</span><span class="mf">0.43</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.24</span><span class="o">+</span><span class="mf">0.4</span><span class="n">j</span> <span class="p">,</span>  <span class="mf">0.02</span><span class="o">+</span><span class="mf">1.08</span><span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>        <span class="mf">0.07</span><span class="o">-</span><span class="mf">0.57</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.21</span><span class="o">+</span><span class="mf">1.08</span><span class="n">j</span><span class="p">,</span>  <span class="mf">1.38</span><span class="o">+</span><span class="mf">0.54</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.35</span><span class="o">+</span><span class="mf">0.3</span><span class="n">j</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.61</span><span class="o">+</span><span class="mf">1.08</span><span class="n">j</span><span class="p">,</span>
<span class="gp">... </span>       <span class="o">-</span><span class="mf">0.96</span><span class="o">+</span><span class="mf">1.81</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.95</span><span class="o">+</span><span class="mf">1.64</span><span class="n">j</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">complex_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">complex_x</span><span class="p">)</span>  <span class="c1"># Canned DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">complex_X_again</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">complex_x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">S</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">complex_x</span><span class="p">)</span>  <span class="c1"># Our DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We get the same result as the canned DFT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">complex_X</span><span class="p">,</span> <span class="n">complex_X_again</span><span class="p">)</span>
</pre></div>
</div>
<p>The sketch of the complex forward DFT looks like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">DFTSketch</span><span class="p">(</span><span class="n">complex_x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Forward DFT for complex input vector&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-14.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-14.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-14.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-14.png" src="_images/fourier_no_ei_orig-14.png" />
</figure>
<p>The input <span class="math notranslate nohighlight">\(\vec{x}\)</span> vectors following <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span>
are now complex, with a real and a complex column for the real and
complex vectors in <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<p>For what follows, unless we say otherwise, we will always be talking
about real number input to the DFT.</p>
</section>
</section>
<section id="some-properties-of-the-cosine-and-sine-basis-matrices">
<h2>Some properties of the cosine and sine basis matrices<a class="headerlink" href="#some-properties-of-the-cosine-and-sine-basis-matrices" title="Link to this heading">¶</a></h2>
<p>First we note that <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> are always real matrices,
regardless of the input <span class="math notranslate nohighlight">\(\vec{x}\)</span> or <span class="math notranslate nohighlight">\(\vec{X}\)</span>.</p>
<p>Let’s show <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> as grayscale images again:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dftp</span><span class="o">.</span><span class="n">show_array</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dftp</span><span class="o">.</span><span class="n">scale_array</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$\mathbf</span><span class="si">{C}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dftp</span><span class="o">.</span><span class="n">show_array</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dftp</span><span class="o">.</span><span class="n">scale_array</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;$\mathbf</span><span class="si">{S}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-15.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-15.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-15.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-15.png" src="_images/fourier_no_ei_orig-15.png" />
</figure>
<section id="mirror-symmetry">
<h3>Mirror symmetry<a class="headerlink" href="#mirror-symmetry" title="Link to this heading">¶</a></h3>
<p>From the images we see that the bottom half of <span class="math notranslate nohighlight">\(\C\)</span> looks like a
mirror image of the top half of <span class="math notranslate nohighlight">\(\C\)</span>. The bottom half of
<span class="math notranslate nohighlight">\(\S\)</span> looks like a sign flipped (black <span class="math notranslate nohighlight">\(\Leftrightarrow\)</span>
white) mirror image of the top half of <span class="math notranslate nohighlight">\(\S\)</span>. In fact this is
correct:</p>
<div class="math notranslate nohighlight">
\[\begin{split}C_{p,:} = C_{N-p,:} \; \mathrm{for} \; p &gt; 0 \\
S_{p,:} = -S_{N-p,:} \; \mathrm{for} \; p &gt; 0\end{split}\]</div>
<p>Why is this? Let’s look at lines from the center of <span class="math notranslate nohighlight">\(\C\)</span>. Here we
are plotting the continuous cosine function with dotted lines, with
filled circles to represent the discrete samples we took to fill the row
of <span class="math notranslate nohighlight">\(\C\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">center_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">N</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">plot_cs_rows</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">center_rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Rows $N / 2 - 1$ through $N / 2 + 1$ of $\mathbf</span><span class="si">{C}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-16.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-16.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-16.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-16.png" src="_images/fourier_no_ei_orig-16.png" />
</figure>
<p>The first plot in this grid is for row <span class="math notranslate nohighlight">\(k = N / 2 - 1\)</span>. This row
starts sampling just before the peak and trough of the cosine. In the
center is row <span class="math notranslate nohighlight">\(k = N / 2\)</span> of <span class="math notranslate nohighlight">\(\C\)</span>. This is sampling the
cosine wave exactly at the peak and trough. When we get to next row, at
<span class="math notranslate nohighlight">\(k = N / 2 + 1\)</span>, we start sampling after the peak and trough of
the cosine, and these samples are identical to the samples just before
the peak and trough, at row <span class="math notranslate nohighlight">\(k = N / 2 - 1\)</span>. Row <span class="math notranslate nohighlight">\(k = N / 2\)</span>
is sampling at the Nyquist sampling frequency, and row
<span class="math notranslate nohighlight">\(k = N / 2 + 1\)</span> is sampling at a frequency lower than Nyquist and
therefore it is being <em>aliased</em> to the same apparent frequency as row
<span class="math notranslate nohighlight">\(k = N / 2 - 1\)</span>.</p>
<p>This might be more obvious plotting rows 1 and N-1 of <span class="math notranslate nohighlight">\(\C\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">plot_cs_rows</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Rows $1$ and $N - 1$ of $\mathbf</span><span class="si">{C}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-17.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-17.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-17.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-17.png" src="_images/fourier_no_ei_orig-17.png" />
</figure>
<p>Of course we get the same kind of effect for <span class="math notranslate nohighlight">\(\S\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">plot_cs_rows</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">center_rows</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Rows $N / 2 - 1$ through $N / 2 + 1$ of $\mathbf</span><span class="si">{S}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-18.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-18.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-18.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-18.png" src="_images/fourier_no_ei_orig-18.png" />
</figure>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">plot_cs_rows</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Rows $1$ and $N - 1$ of $\mathbf</span><span class="si">{S}</span><span class="s1">$&#39;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-19.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-19.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-19.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-19.png" src="_images/fourier_no_ei_orig-19.png" />
</figure>
<p>Notice that for <span class="math notranslate nohighlight">\(\S\)</span>, the sine waves after <span class="math notranslate nohighlight">\(k = N / 2\)</span> are
sign-flipped relative to their matching rows before <span class="math notranslate nohighlight">\(k = N / 2\)</span>.
Thus row <span class="math notranslate nohighlight">\(k = N / 2 + 1\)</span> will be aliased to the same frequency as
for row <span class="math notranslate nohighlight">\(k = N / 2 - 1\)</span>, but with a negative sign.</p>
<p>It is this sign-flip that leads to the concept of <em>negative frequency</em>
in the DFT, and to the property of <em>conjugate symmetry</em> from the DFT on
a vector of real numbers. We will hear more about these later.</p>
</section>
<section id="matrix-symmetry">
<h3>Matrix symmetry<a class="headerlink" href="#matrix-symmetry" title="Link to this heading">¶</a></h3>
<p>The next thing we notice about <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> is that they
are transpose <em>symmetric</em> matrices:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\C = \C^T \\
\S = \S^T \\\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p>Why is this? Consider the first <em>column</em> of <span class="math notranslate nohighlight">\(\C\)</span>. This is given by
<span class="math notranslate nohighlight">\(\cos(k 2 \pi 0 / N) = \cos(0)\)</span>, and thus, like the first <em>row</em> of
<span class="math notranslate nohighlight">\(\C\)</span>, is always = 1.</p>
<p>Now consider the second row of <span class="math notranslate nohighlight">\(\C\)</span>. This is a cosine sampled at
horizontal axis values:</p>
<div class="math notranslate nohighlight">
\[\vec{t_1} \triangleq \left[ 2 \pi \frac{n}{N} \;\mathrm{for}\; n \in
0,1,\ldots,N-1 \right]\]</div>
<p>Call <span class="math notranslate nohighlight">\(t_{k, n}\)</span> the value of <span class="math notranslate nohighlight">\(\vec{t_k}\)</span> at index <span class="math notranslate nohighlight">\(n\)</span>.
Now consider the second <em>column</em> of <span class="math notranslate nohighlight">\(\C\)</span>. This is a cosine sampled
at horizontal axis values for <span class="math notranslate nohighlight">\(n = 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}t_{0,1} = (0) 2 \pi \frac{1}{N} \\
t_{1,1} = (1) 2 \pi \frac{1}{N} \\
... \\
t_{N-1,1} = (N-1) 2 \pi \frac{1}{N} \\\end{split}\]</div>
<p>In general, because the sequence <span class="math notranslate nohighlight">\(k 0,1,,N-1 \)</span> is equal to the sequence
<span class="math notranslate nohighlight">\(n \in 0,1,\ldots,N-1\)</span>, this means that the column sampling
positions for row <span class="math notranslate nohighlight">\(n \in t_{0, n}, t_{1, n}, ... , t_{N-1, n}\)</span> are
equal to the row sampling positions for corresponding (<span class="math notranslate nohighlight">\(k = n\)</span>)
row <span class="math notranslate nohighlight">\(k \in t_{k, 0}, t_{k, 1}, ... , t_{k, N-1}\)</span>. Write column
<span class="math notranslate nohighlight">\(z\)</span> of <span class="math notranslate nohighlight">\(\C\)</span> as <span class="math notranslate nohighlight">\(C_{:,z}\)</span>; column <span class="math notranslate nohighlight">\(z\)</span> of
<span class="math notranslate nohighlight">\(\S\)</span> is <span class="math notranslate nohighlight">\(S_{:, z}\)</span>. Therefore
<span class="math notranslate nohighlight">\(C_{z, :} = C_{:, z}, S_{z, :} = S_{:, z}\)</span>.</p>
</section>
<section id="row-dot-products-and-lengths">
<h3>Row dot products and lengths<a class="headerlink" href="#row-dot-products-and-lengths" title="Link to this heading">¶</a></h3>
<p>It is useful to look at the dot products of the rows of <span class="math notranslate nohighlight">\(\C\)</span> and
<span class="math notranslate nohighlight">\(\S\)</span>. The dot product of each row with itself gives the squared
<em>length</em> of the vector in that row.</p>
<p>The vector length of a vector <span class="math notranslate nohighlight">\(\vec{v}\)</span> with <span class="math notranslate nohighlight">\(N\)</span> elements is
written as <span class="math notranslate nohighlight">\(\| \vec{v} \|\)</span>, and defined as:</p>
<div class="math notranslate nohighlight">
\[\| \vec{v} \| \triangleq \sqrt{\sum_{n=0}^{N-1} v_n^2}
= \sqrt{ \vec{v} \cdot \vec{v} }\]</div>
<p>The dot products of different rows of <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> give an
index of the strength of the relationship between the rows. We can look
at the dot products of all the rows of <span class="math notranslate nohighlight">\(\C\)</span> with all other rows
with the matrix multiplication <span class="math notranslate nohighlight">\(\C^T \C\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dftp</span><span class="o">.</span><span class="n">show_array</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">dftp</span><span class="o">.</span><span class="n">scale_array</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$\mathbf{C^TC}$&quot;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-21.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-21.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-21.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-21.png" src="_images/fourier_no_ei_orig-21.png" />
</figure>
<p>The image shows us that the dot product between the rows of <span class="math notranslate nohighlight">\(\C\)</span>
is 0 everywhere except:</p>
<ul class="simple">
<li><p>the dot products of the rows with themselves (the squared vector
lengths);</p></li>
<li><p>the dot products of the mirror image vectors such as
<span class="math notranslate nohighlight">\(\vec{c_1}\)</span> and <span class="math notranslate nohighlight">\(\vec{c_{N-1}}\)</span>. Because
<span class="math notranslate nohighlight">\(\vec{c_n} = \vec{c_{N-n}}\)</span>, these dot products are the same as
the <span class="math notranslate nohighlight">\(\| \vec{c_n} \|^2\)</span>.</p></li>
</ul>
<p>The squared row lengths are:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="go">array([ 32.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,</span>
<span class="go">        16.,  16.,  16.,  16.,  16.,  32.,  16.,  16.,  16.,  16.,  16.,</span>
<span class="go">        16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.])</span>
</pre></div>
</div>
<p>Notice that the rows <span class="math notranslate nohighlight">\(\vec{c_0}\)</span> and <span class="math notranslate nohighlight">\(\vec{c_{N / 2}}\)</span> have
squared length <span class="math notranslate nohighlight">\(N\)</span>, and the other rows have squared length
<span class="math notranslate nohighlight">\(N / 2\)</span>.</p>
<p>We can do the same for <span class="math notranslate nohighlight">\(\S\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dftp</span><span class="o">.</span><span class="n">show_array</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">dftp</span><span class="o">.</span><span class="n">scale_array</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$\mathbf{S^TS}$&quot;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-23.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-23.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-23.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-23.png" src="_images/fourier_no_ei_orig-23.png" />
</figure>
<p>Remember that <span class="math notranslate nohighlight">\(\vec{s_0}\)</span> and <span class="math notranslate nohighlight">\(\vec{s_{n/2}}\)</span> are all 0
vectors. The dot product of these rows with any other row, including
themselves, is 0. All other entries in this <span class="math notranslate nohighlight">\(\S^T \S\)</span> matrix are
zero except:</p>
<ul class="simple">
<li><p>the dot products of rows with themselves (other than
<span class="math notranslate nohighlight">\(\vec{s_0}\)</span> and <span class="math notranslate nohighlight">\(\vec{s_{n/2}}\)</span>);</p></li>
<li><p>the dot products of the flipped mirror image vectors such as
<span class="math notranslate nohighlight">\(\vec{s_1}\)</span> and <span class="math notranslate nohighlight">\(\vec{s_{N-1}}\)</span>. Because
<span class="math notranslate nohighlight">\(\vec{s_n} = -\vec{s_{N-n}}\)</span>, these dot products are the same
as <span class="math notranslate nohighlight">\(-\| \vec{s_n} \|^2\)</span>.</p></li>
</ul>
<p>The squared row lengths are:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<span class="go">array([  0.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,</span>
<span class="go">        16.,  16.,  16.,  16.,  16.,   0.,  16.,  16.,  16.,  16.,  16.,</span>
<span class="go">        16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.,  16.])</span>
</pre></div>
</div>
<p>The rows <span class="math notranslate nohighlight">\(\vec{s_0}\)</span> and <span class="math notranslate nohighlight">\(\vec{s_{N / 2}}\)</span> have squared
length <span class="math notranslate nohighlight">\(0\)</span>, and the other rows have squared length <span class="math notranslate nohighlight">\(N / 2\)</span>.</p>
<p>Finally, let’s look at the relationship between the rows of <span class="math notranslate nohighlight">\(\C\)</span>
and the rows of <span class="math notranslate nohighlight">\(\S\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">S</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The rows of <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> are completely orthogonal.</p>
<p>In fact these relationships hold for <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> for any
<span class="math notranslate nohighlight">\(N\)</span>.</p>
<section id="proof-for-c-s-dot-products">
<h4>Proof for <span class="math notranslate nohighlight">\(\C, \S\)</span> dot products<a class="headerlink" href="#proof-for-c-s-dot-products" title="Link to this heading">¶</a></h4>
<p>We can show these relationships with some more or less basic
trigonometry.</p>
<p>Let’s start by looking at the dot product of two rows from <span class="math notranslate nohighlight">\(\C\)</span>.
We will take rows <span class="math notranslate nohighlight">\(\vec{c_p} =\C_{p,:}\)</span> and
<span class="math notranslate nohighlight">\(\vec{c_q} = \C_{q,:}\)</span>. As we remember, these vectors are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{c_p} = \left[ \cos(p n \frac{2 \pi}{N}) \;\mathrm{for}\;
n \in 0,1,\ldots,N-1 \right] \\
\vec{c_q} = \left[ \cos(q n \frac{2 \pi}{N}) \;\mathrm{for}\;
n \in 0,1,\ldots,N-1 \right]\end{split}\]</div>
<p>So:</p>
<div class="math notranslate nohighlight">
\[\vec{c_p} \cdot \vec{c_q} = \sum_{n=0}^{N-1} \cos(p n \frac{2 \pi}{N}) \cos(q
n \frac{2 \pi}{N})\]</div>
<p>Our trigonometry tells us that:</p>
<div class="math notranslate nohighlight">
\[\cos \alpha \cos \beta = \frac{1}{2} [ \cos(\alpha + \beta) - \cos(\alpha -
\beta) ]\]</div>
<p>We can rewrite the dot product as the addition of two sums of cosines:</p>
<div class="math notranslate nohighlight">
\[\vec{c_p} \cdot \vec{c_q} =
\frac{1}{2} \sum_{n=0}^{N-1} \cos((p + q) n \frac{2 \pi}{N}) +
\frac{1}{2} \sum_{n=0}^{N-1} \cos((p - q) n \frac{2 \pi}{N})\]</div>
<p>Now we can use the formulae for sums of <a class="reference external" href="sum_of_cosines.html">arithmetic progressions of
cosines and sines</a> to solve these equations.
Here are the formulae:</p>
<div class="math notranslate nohighlight">
\[\begin{split}R \triangleq \frac{\sin(N \frac{1}{2}d)}{\sin(\frac{1}{2} d)} \\
\sum_{n=0}^{N-1} \cos(a + nd) =
\begin{cases}
N \cos a &amp; \text{if } \sin(\frac{1}{2}d) = 0 \\
R \cos ( a + (N - 1) \frac{1}{2} d) &amp; \text{otherwise}
\end{cases}
\\
\sum_{n=0}^{N-1} \sin(a + nd) =
\begin{cases}
N \sin a &amp; \text{if } \sin(\frac{1}{2}d) = 0 \\
R \sin ( a + (N - 1) \frac{1}{2} d) &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>For our <span class="math notranslate nohighlight">\(\C, \S\)</span> row dot product sums, starting angle <span class="math notranslate nohighlight">\(a\)</span> is
always 0, and the <span class="math notranslate nohighlight">\(d\)</span> value in the formulae are always integer
multiples of <span class="math notranslate nohighlight">\(\frac{2 \pi}{N}\)</span>. For example,
<span class="math notranslate nohighlight">\(d = (p \pm q) \frac{2 \pi}{N}\)</span> in the equations above. For our
case, we can write <span class="math notranslate nohighlight">\(d = g \frac{2 \pi}{N}\)</span> where <span class="math notranslate nohighlight">\(g\)</span> is an
integer.</p>
<div class="math notranslate nohighlight">
\[\begin{split}R = \frac{
\sin( g N \frac{1}{2} \frac{2 \pi}{N} )
}
{
\sin( g \frac{1}{2} \frac{2 \pi}{N} )
} \\
= \frac{ \sin( g \pi ) } { \sin( \frac{g}{N} \pi ) }\end{split}\]</div>
<p>Because <span class="math notranslate nohighlight">\(g\)</span> is an integer, the numerator of <span class="math notranslate nohighlight">\(R\)</span> will always
be 0, so the resulting sum is zero unless the denominator of <span class="math notranslate nohighlight">\(R\)</span>
is zero. The denominator is zero only if <span class="math notranslate nohighlight">\(g\)</span> is a multiple of N,
including 0. When the denominator is zero, the sum will be equal to
<span class="math notranslate nohighlight">\(N \cos(a) = N \cos(0) = N\)</span> for a cosine series or
<span class="math notranslate nohighlight">\(N \sin(a) = N \sin(0) = 0\)</span> for a sine series.</p>
<p>Now we can calculate our dot product:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{c_p} \cdot \vec{c_q} =
\begin{cases}
\frac{1}{2} N + \frac{1}{2} N = N &amp; \text{if } p = q, p \in 0, N/2 \\
\frac{1}{2} N &amp; \text{if } p = q, p \notin 0, N/2 \\
\frac{1}{2} N &amp; \text{if } p + q = N, p \ne N/2 \\
0 &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>We can apply the same kind of logic to the rows of <span class="math notranslate nohighlight">\(\S\)</span>:</p>
<div class="math notranslate nohighlight">
\[\sin \alpha \sin \beta = \frac{1}{2} [ \cos(\alpha - \beta) - \cos(\alpha +
\beta) ]\]</div>
<p>So:</p>
<div class="math notranslate nohighlight">
\[\vec{s_p} \cdot \vec{s_q} =
\frac{1}{2} \sum_{n=0}^{N-1} \cos((p - q) n \frac{2 \pi}{N}) -
\frac{1}{2} \sum_{n=0}^{N-1} \cos((p + q) n \frac{2 \pi}{N})\]</div>
<p>This gives:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{s_p} \cdot \vec{s_q} =
\begin{cases}
0 &amp; \text{if } p = q, p \in 0, N/2 \\
\frac{1}{2} N &amp; \text{if } p = q, p \notin 0, N/2 \\
-\frac{1}{2} N &amp; \text{if } p + q = N, p \ne N/2 \\
0 &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
</section>
</section>
<section id="introducing-vector-projection">
<h3>Introducing vector projection<a class="headerlink" href="#introducing-vector-projection" title="Link to this heading">¶</a></h3>
<p>If you are not familiar with projection, I highly recommend the
tutorials over at <a class="reference external" href="https://www.khanacademy.org/math/linear-%20algebra/matrix_transformations/lin_trans_examples/v/introduction-to-%20projections">Khan
academy</a>.</p>
<p>If you know projection, you may think of a dot product like
<span class="math notranslate nohighlight">\(\vec{x} \cdot \vec{c_k}\)</span> as part of the projection of our input
signal <span class="math notranslate nohighlight">\(\vec{x}\)</span> onto the cosine vector <span class="math notranslate nohighlight">\(\vec{c_k}\)</span>.</p>
<p>Projection involves calculating the amount of a particular signal vector
(such as a cosine wave) in another signal vector (such as our input data
<span class="math notranslate nohighlight">\(\vec{x}\)</span>).</p>
<p>The Pearson product-moment correlation coefficient uses the dot product
to test for relationship between two variables. In our case, except for
the first cosine vector <span class="math notranslate nohighlight">\(\vec{c_0} = \vec{1}\)</span>, the dot products
<span class="math notranslate nohighlight">\(\vec{x} \cdot \vec{c_k}\)</span> and <span class="math notranslate nohighlight">\(\vec{x} \cdot \vec{s_k}\)</span> are
proportional to the Pearson product-moment correlation coefficient
between <span class="math notranslate nohighlight">\(\vec{c_k}\)</span> and <span class="math notranslate nohighlight">\(\vec{x}\)</span> or <span class="math notranslate nohighlight">\(\vec{s_k}\)</span> and
<span class="math notranslate nohighlight">\(\vec{x}\)</span>, respectively.</p>
<p>The projection of a vector <span class="math notranslate nohighlight">\(\vec{a}\)</span> onto a vector <span class="math notranslate nohighlight">\(\vec{b}\)</span>
is given by:</p>
<div class="math notranslate nohighlight">
\[proj_{\vec{b}}\vec{a} \triangleq g \vec{b}\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is a scalar that we will call the <em>projection
coefficient</em>:</p>
<div class="math notranslate nohighlight">
\[g = \frac{\vec{a} \cdot \vec{b}}{\vec{b} \cdot \vec{b}}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(\vec{b} \cdot \vec{b}\)</span> is also <span class="math notranslate nohighlight">\(\| \vec{b} \|^2\)</span>,
so we can also write:</p>
<div class="math notranslate nohighlight">
\[g = \frac{\vec{a} \cdot \vec{b}}{\| \vec{b} \|^2}\]</div>
<p>The result of the projection <span class="math notranslate nohighlight">\(proj_{\vec{b}}\vec{a}\)</span> is a copy of
<span class="math notranslate nohighlight">\(\vec{b}\)</span> scaled by <span class="math notranslate nohighlight">\(g\)</span> - the scalar amount of
<span class="math notranslate nohighlight">\(\vec{a}\)</span> present in <span class="math notranslate nohighlight">\(\vec{b}\)</span>.</p>
</section>
<section id="forward-and-inverse-dft-as-vector-projection">
<h3>Forward and inverse DFT as vector projection<a class="headerlink" href="#forward-and-inverse-dft-as-vector-projection" title="Link to this heading">¶</a></h3>
</section>
<section id="projection-and-the-dft">
<h3>Projection and the DFT<a class="headerlink" href="#projection-and-the-dft" title="Link to this heading">¶</a></h3>
<p>The principle of the DFT on real input is the following.</p>
<p>In the forward transform:</p>
<ul class="simple">
<li><p>We calculate the data we need to form the projection coefficients for
projecting the input data onto the cosines and sine waves in the rows
of <span class="math notranslate nohighlight">\(\C\)</span> and <span class="math notranslate nohighlight">\(\S\)</span>.</p></li>
<li><p>The projection data for the cosines goes into the real part of
<span class="math notranslate nohighlight">\(\vec{X}\)</span> : <span class="math notranslate nohighlight">\(\R{\vec{X}}\)</span>. The projection data for the
sines goes into the imaginary part <span class="math notranslate nohighlight">\(\I{\vec{X}}\)</span>;</p></li>
</ul>
<p>In the inverse transform:</p>
<ul class="simple">
<li><p>We complete the calculation of the projection coefficients <span class="math notranslate nohighlight">\(g\)</span>
for each cosine and sine wave in <span class="math notranslate nohighlight">\(\C, \S\)</span>;</p></li>
<li><p>We use the projection coefficients to project the original data
<span class="math notranslate nohighlight">\(\vec{X}\)</span> onto the set of cosines and sines in <span class="math notranslate nohighlight">\(\C\)</span>,
<span class="math notranslate nohighlight">\(\S\)</span>. Each projection forms a new output vector, to give
projection vectors
<span class="math notranslate nohighlight">\([proj_{\vec{c_0}} \vec{x}, proj_{\vec{c_1}} \vec{x}, ..., proj_{\vec{s_0}} \vec{x}, proj_{\vec{s_1}} \vec{x}, ...]\)</span>;</p></li>
<li><p>We sum up all the projection vectors to reconstruct the original data
<span class="math notranslate nohighlight">\(\vec{X}\)</span>.</p></li>
</ul>
<p>This is how it works in principle. There are some complications to the
way it works in practice, due to the generality of the DFT in accepting
real and complex input. In the next sections we will go through some
examples to show how the forward and inverse transform work in detail.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Does it actually work?</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_Cs</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_Ss</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">small_n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_Ss</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_dots</span> <span class="o">=</span> <span class="n">unique_Cs</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_dots</span> <span class="o">=</span> <span class="n">unique_Ss</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_gs</span> <span class="o">=</span> <span class="n">cos_dots</span> <span class="o">/</span> <span class="p">([</span><span class="n">N</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">small_n</span> <span class="o">+</span> <span class="p">[</span><span class="n">N</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_gs</span> <span class="o">=</span> <span class="n">sin_dots</span> <span class="o">/</span> <span class="p">([</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">small_n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_projections</span> <span class="o">=</span> <span class="n">cos_gs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">unique_Cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_projections</span> <span class="o">=</span> <span class="n">sin_gs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">unique_Ss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_back</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">cos_projections</span><span class="p">,</span> <span class="n">sin_projections</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_back</span> <span class="o">-</span> <span class="n">x</span>
<span class="go">array([-0.,  0., -0.,  0., -0., -0.,  0., -0.,  0., -0.,  0., -0.,  0.,</span>
<span class="go">       -0., -0.,  0., -0.,  0., -0., -0.,  0.,  0., -0., -0.,  0., -0.,</span>
<span class="go">        0.,  0.,  0., -0.,  0., -0.])</span>
</pre></div>
</div>
</section>
<section id="the-first-element-in-vec-x-for-real-input">
<h3>The first element in <span class="math notranslate nohighlight">\(\vec{X}\)</span> for real input<a class="headerlink" href="#the-first-element-in-vec-x-for-real-input" title="Link to this heading">¶</a></h3>
<p>From our matrix multiplication, we know the first element of
<span class="math notranslate nohighlight">\(\vec{X}\)</span> comes from:</p>
<div class="math notranslate nohighlight">
\[X_0 = C_{0, :} \cdot \vec{x} - i S_{0, :} \cdot \vec{x}
    = \vec{c_0} \cdot \vec{x} - i \vec{s_0} \cdot \vec{x}\]</div>
<p>We can represent this by highlighting the relevant parts of the matrix
multiplication:</p>
<p>We can simplify further because we know what <span class="math notranslate nohighlight">\(\vec{c_0}\)</span> and
<span class="math notranslate nohighlight">\(\vec{s_0}\)</span> are:</p>
<div class="math notranslate nohighlight">
\[X_0 = \vec{1} \cdot \vec{x} - i \vec{0} \cdot \vec{x}
    = \vec{1} \cdot \vec{x}\]</div>
<p>This final dot product can also be written as:</p>
<div class="math notranslate nohighlight">
\[X_0 = \sum_{n=0}^{N-1}{x_n}\]</div>
<p>That is, <span class="math notranslate nohighlight">\(X_0\)</span> is a complex number with imaginary part = 0, where
the real part contains the sum of the elements in <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<p>Is this true of our original input vector <span class="math notranslate nohighlight">\(\vec{x}\)</span>?</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of x&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">Sum of x -4.3939</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First DFT coefficient X[0]&#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">First DFT coefficient X[0] (-4.3939+0j)</span>
</pre></div>
</div>
<p>We can show how <span class="math notranslate nohighlight">\(X_0\)</span> comes about in the matrix multiplication by
highlighting</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(X_0\)</span>;</p></li>
<li><p>the relevant row of <span class="math notranslate nohighlight">\(\C\)</span> : <span class="math notranslate nohighlight">\(C_{0,:}\)</span>;</p></li>
<li><p>the vector <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p></li>
</ul>
<p>We can leave out the relevant row of <span class="math notranslate nohighlight">\(\S\)</span> : <span class="math notranslate nohighlight">\(S_{0,:}\)</span>
because it is all 0.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">DFTSketch</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;X_real&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;x_c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-28.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-28.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-28.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-28.png" src="_images/fourier_no_ei_orig-28.png" />
</figure>
</section>
<section id="dft-of-a-constant-input-vector">
<h3>DFT of a constant input vector<a class="headerlink" href="#dft-of-a-constant-input-vector" title="Link to this heading">¶</a></h3>
<p>Next we will consider the forward and inverse DFT of an input vector
that is constant.</p>
<p>Our input is vector with <span class="math notranslate nohighlight">\(N\)</span> elements, where every element = 2:</p>
<div class="math notranslate nohighlight">
\[\vec{w} = [2, 2, ... 2]\]</div>
<p>We could also write <span class="math notranslate nohighlight">\(\vec{w}\)</span> as <span class="math notranslate nohighlight">\(\vec{2}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span>
<span class="go">array([ 2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,</span>
<span class="go">        2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,  2.,</span>
<span class="go">        2.,  2.,  2.,  2.,  2.,  2.])</span>
</pre></div>
</div>
<p>What DFT output <span class="math notranslate nohighlight">\(\vec{W}\)</span> will this generate?</p>
<p>We already know that <span class="math notranslate nohighlight">\(W_0\)</span> must be the sum of <span class="math notranslate nohighlight">\(\vec{w}\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sum of w&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
<span class="go">Sum of w 64.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First DFT coefficient W[0]&#39;</span><span class="p">,</span> <span class="n">W</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">First DFT coefficient W[0] (64+0j)</span>
</pre></div>
</div>
<p>How about the rest of <span class="math notranslate nohighlight">\(\vec{W}\)</span>? All the remaining cosine and sine
waves in <span class="math notranslate nohighlight">\(\C, \S\)</span> sum to zero over the rows (and columns):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sums over rows of C after first&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Sums over rows of C after first [-0. -0. -0. -0. -0. -0.  0. -0.  0. -0. -0.  0. -0. -0. -0.  0. -0.  0.</span>
<span class="go"> -0. -0.  0.  0. -0.  0. -0.  0.  0.  0.  0. -0.  0.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sums over rows of S&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">Sums over rows of S [ 0. -0. -0. -0.  0.  0.  0. -0.  0.  0.  0.  0.  0. -0. -0.  0. -0. -0.</span>
<span class="go">  0. -0.  0.  0.  0.  0.  0. -0.  0.  0.  0. -0.  0.  0.]</span>
</pre></div>
</div>
<p>For any vector <span class="math notranslate nohighlight">\(\vec{v}\)</span> that sums to zero, the dot product
<span class="math notranslate nohighlight">\(\vec{2} \cdot \vec{v}\)</span> will be
<span class="math notranslate nohighlight">\(\sum_{n=0}^{N-1} 2 v_n = 2 \sum_{n=0}^{N-1} v_n = 0\)</span>.</p>
<p>So, we predict that all the rest of <span class="math notranslate nohighlight">\(W_0\)</span>, real and imaginary,
will be 0:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">W</span>
<span class="go">array([ 64.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,   0.+0.j,</span>
<span class="go">         0.+0.j,   0.+0.j])</span>
</pre></div>
</div>
<p>Let us show this in the matrix form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">DFTSketch</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;X_real&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;x_c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-33.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-33.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-33.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-33.png" src="_images/fourier_no_ei_orig-33.png" />
</figure>
</section>
<section id="cosines-in-the-real-part-sines-in-the-imaginary-part">
<h3>Cosines in the real part, sines in the imaginary part<a class="headerlink" href="#cosines-in-the-real-part-sines-in-the-imaginary-part" title="Link to this heading">¶</a></h3>
<p>The following only applies to real input to the DFT.</p>
<p>From the forward DFT formula on a vector of real numbers, we see that
the <span class="math notranslate nohighlight">\(\R{X}\)</span> will contain the dot product of <span class="math notranslate nohighlight">\(\vec{x}\)</span> with
the cosine basis, and <span class="math notranslate nohighlight">\(\I{X}\)</span> will contain the dot product of
<span class="math notranslate nohighlight">\(\vec{x}\)</span> with the sine basis.</p>
<p>Imagine, for simplicity, that <span class="math notranslate nohighlight">\(\vec{s_k} \cdot \vec{x} = 0\)</span> for
every <span class="math notranslate nohighlight">\(k\)</span>, or (saying the same thing in a different way)
<span class="math notranslate nohighlight">\(\S \cdot \vec{x} = \vec{0}\)</span>.</p>
<p>In that case our forward DFT would be:</p>
<div class="math notranslate nohighlight">
\[X = \C \cdot \vec{x}\]</div>
<p>and the inverse DFT would be:</p>
<div class="math notranslate nohighlight">
\[X = \frac{1}{N} \C \cdot \vec{X}\]</div>
<p>In that case, <span class="math notranslate nohighlight">\(\vec{X}\)</span> would be a vector of real numbers, each
expressing the amount of the corresponding cosine vector is present in
the data.</p>
<p>We could then perfectly reconstruct our original data by summing up the
result of projecting onto each cosine vector.</p>
<p>In the case of our constant input vector <span class="math notranslate nohighlight">\(\vec{w}\)</span>, this is the
case - there are no sine components in <span class="math notranslate nohighlight">\(\vec{w}\)</span> and
<span class="math notranslate nohighlight">\(\S \cdot \vec{x} = \vec{0}\)</span>.</p>
<p>So, <span class="math notranslate nohighlight">\(\R{\vec{X}}\)</span> contains all the information in <span class="math notranslate nohighlight">\(\vec{w}\)</span>.
In fact, as we have seen, <span class="math notranslate nohighlight">\(\R{X_0}\)</span> contains all the information
in <span class="math notranslate nohighlight">\(\vec{w}\)</span>.</p>
<p>Rephrasing in terms of projection, <span class="math notranslate nohighlight">\(W_0\)</span> comes from
<span class="math notranslate nohighlight">\(\vec{1} \cdot \vec{w}\)</span>. This the top half of the <span class="math notranslate nohighlight">\(g\)</span> value
for projecting the signal <span class="math notranslate nohighlight">\(\vec{w}\)</span> onto a vector of ones
<span class="math notranslate nohighlight">\(\vec{c_0}\)</span> :
<span class="math notranslate nohighlight">\(g = \frac{\vec{w} \cdot \vec{1}}{\vec{1} \cdot \vec{1}}\)</span>. We know
<span class="math notranslate nohighlight">\(\vec{1} \cdot \vec{1} = N\)</span> so the projection of <span class="math notranslate nohighlight">\(\vec{w}\)</span>
onto <span class="math notranslate nohighlight">\(\vec{1}\)</span> is
<span class="math notranslate nohighlight">\(\frac{\vec{w} \cdot \vec{1}}{\vec{1} \cdot \vec{1}} \vec{1} = \frac{1}{N} \vec{w} \cdot \vec{1}\)</span>,
and this is precisely what the inverse DFT will do:</p>
<div class="math notranslate nohighlight">
\[\begin{split}w_0 = \frac{1}{N} \vec{1} \cdot \vec{W} - i \frac{1}{N} \vec{0} \cdot \vec{W} =
\frac{1}{N} \vec{1} \cdot \vec{W} \\
w_1 = \frac{1}{N} \vec{1} \cdot \vec{W} \\
... \\
w_{N-1} = \frac{1}{N} \vec{1} \cdot \vec{W}\end{split}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w_again</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">w_again</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">c_0</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_again</span>
<span class="go">array([ 2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j])</span>
</pre></div>
</div>
<p>In matrix form:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mf">1.</span> <span class="o">/</span> <span class="n">N</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">array([ 2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j,</span>
<span class="go">        2.+0.j,  2.+0.j,  2.+0.j,  2.+0.j])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span> <span class="o">=</span> <span class="n">dftp</span><span class="o">.</span><span class="n">DFTSketch</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">sketch</span><span class="p">(</span><span class="n">inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;x_real&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sketch</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="s1">&#39;X_c_real&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-36.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-36.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-36.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-36.png" src="_images/fourier_no_ei_orig-36.png" />
</figure>
</section>
<section id="dft-on-a-signal-with-a-single-cosine">
<h3>DFT on a signal with a single cosine<a class="headerlink" href="#dft-on-a-signal-with-a-single-cosine" title="Link to this heading">¶</a></h3>
<p>Now let us look at the second coefficient, <span class="math notranslate nohighlight">\(X_1\)</span>.</p>
<p>This was formed by dot products of the signal with cosine and sine waves
having a single cycle across the whole signal:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{t_1} \triangleq \left[ 2 \pi \frac{n}{N} \;\mathrm{for}\; n \in
0,1,\ldots,N-1 \right] \\
\vec{c_1} \triangleq \left[ \cos(t_{1,n}) \;\mathrm{for}\; n \in 0,1,\ldots,N-1
\right] \\
\vec{s_1} \triangleq \left[ \sin(t_{1,n}) \;\mathrm{for}\; n \in 0,1,\ldots,N-1
\right]\end{split}\]</div>
<p>Here are plots of <span class="math notranslate nohighlight">\(\vec{c_1}, \vec{s_1}\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t_1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ns</span> <span class="o">/</span> <span class="n">N</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t_1</span><span class="p">),</span> <span class="s1">&#39;o:&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t_1</span><span class="p">),</span> <span class="s1">&#39;o:&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-37.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-37.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-37.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-37.png" src="_images/fourier_no_ei_orig-37.png" />
</figure>
<p>If the input signal is a single cosine wave of amplitude 3, with one
cycle over the signal, then we can predict <span class="math notranslate nohighlight">\(X_1\)</span>. It will be the
dot product of the input signal with <span class="math notranslate nohighlight">\(c_1\)</span>, which is the same as
<span class="math notranslate nohighlight">\(3 c_1 \cdot c_1\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">ns</span> <span class="o">/</span> <span class="n">N</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos_x</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">cos_x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First DFT coefficient for single cosine&#39;</span><span class="p">,</span> <span class="n">to_4dp</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">First DFT coefficient for single cosine 48.0000-0.0000j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dot product of single cosine with c_1&#39;</span><span class="p">,</span> <span class="n">cos_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">))</span>
<span class="go">Dot product of single cosine with c_1 48.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;3 * dot product of c_1 with itself&#39;</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c_1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">))</span>
<span class="go">3 * dot product of c_1 with itself 48.0</span>
</pre></div>
</div>
</section>
<section id="fitting-all-cosine-phases-with-an-added-sine">
<h3>Fitting all cosine phases with an added sine<a class="headerlink" href="#fitting-all-cosine-phases-with-an-added-sine" title="Link to this heading">¶</a></h3>
<p>Now it is time to bring the <span class="math notranslate nohighlight">\(i \vec{x} \cdot \vec{s_k}\)</span> part of
the DFT into play.</p>
<p>By calculating the dot product of our input vector with a cosine wave of
a given frequency, we detect any signal that matches that cosine with
the given phase and the given frequency. In our example above, we used
the DFT <span class="math notranslate nohighlight">\(\vec{c_1}\)</span> dot product to detect a cosine with phase
offset 0 - the cosine starts at <span class="math notranslate nohighlight">\(n = 0\)</span>.</p>
<p>What happens if the cosine in the signal has a different phase? For
example, what happens to the dot product if the cosine wave in our data
is shifted by 0.8,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cos_x_shifted</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t_1</span> <span class="o">+</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_1</span><span class="p">,</span> <span class="n">cos_x_shifted</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dot product of shifted cosine with c_1&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">to_4dp</span><span class="p">(</span><span class="n">cos_x_shifted</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">)))</span>
<span class="go">Dot product of shifted cosine with c_1 33.4419</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-39.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-39.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-39.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-39.png" src="_images/fourier_no_ei_orig-39.png" />
</figure>
<p>When the cosine wave is shifted in our data, relative to the
<span class="math notranslate nohighlight">\(\vec{c_1}\)</span>, then the dot product of the signal against
<span class="math notranslate nohighlight">\(\vec{c_1}\)</span> drops in value, and is therefore less successful at
detecting this cosine wave.</p>
<p>This is the role of the <span class="math notranslate nohighlight">\(\vec{s_k}\)</span> vectors in the DFT. By
calculating dot products with the <span class="math notranslate nohighlight">\(\vec{s_k}\)</span> vectors, we can
detect cosine waves of any phase.</p>
<p>Let us see that in action first, and then explain why this is so.</p>
<p>First, here is what happens to the dot products for the shifted and
unshifted cosine waves:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_1</span><span class="p">,</span> <span class="n">cos_x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3 * cos wave&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_1</span><span class="p">,</span> <span class="n">cos_x_shifted</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;3 * cos wave, shifted&#39;</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dot product of unshifted cosine with c_1&#39;</span><span class="p">,</span> <span class="n">cos_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">))</span>
<span class="go">Dot product of unshifted cosine with c_1 48.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dot product of unshifted cosine with s_1&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">to_4dp</span><span class="p">(</span><span class="n">cos_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s_1</span><span class="p">)))</span>
<span class="go">Dot product of unshifted cosine with s_1 -0.0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dot product of shifted cosine with c_1&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">to_4dp</span><span class="p">(</span><span class="n">cos_x_shifted</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">)))</span>
<span class="go">Dot product of shifted cosine with c_1 33.4419</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dot product of shifted cosine with s_1&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">to_4dp</span><span class="p">(</span><span class="n">cos_x_shifted</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s_1</span><span class="p">)))</span>
<span class="go">Dot product of shifted cosine with s_1 -34.4331</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-40.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-40.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-40.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-40.png" src="_images/fourier_no_ei_orig-40.png" />
</figure>
<p>Notice that the dot product with <span class="math notranslate nohighlight">\(\vec{s_1}\)</span> is effectively zero
in the unshifted case, and goes up to around 34 in the shifted case.</p>
<p>Now let us use the projections from these dot products to reconstruct
the original vector (as we will soon do using the inverse DFT).</p>
<p>First we use the dot product with <span class="math notranslate nohighlight">\(\vec{c_1}\)</span> to reconstruct the
unshifted cosine (the dot product with <span class="math notranslate nohighlight">\(\vec{s_1}\)</span> is zero, so we
do not need it).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reconstruct unshifted cos from dot product projection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_unshifted</span> <span class="o">=</span> <span class="n">cos_x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">)</span> <span class="o">/</span> <span class="n">c_1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proj_onto_c1</span> <span class="o">=</span> <span class="n">c_unshifted</span> <span class="o">*</span> <span class="n">c_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">proj_onto_c1</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reconstructed unshifted cosine&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-41.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-41.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-41.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-41.png" src="_images/fourier_no_ei_orig-41.png" />
</figure>
<p>Now we can use the cosine and sine dot product to reconstruct the
shifted cosine vector:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reconstruct shifted cos from dot product projection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_cos_shifted</span> <span class="o">=</span> <span class="n">cos_x_shifted</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">)</span> <span class="o">/</span> <span class="n">c_1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_sin_shifted</span> <span class="o">=</span> <span class="n">cos_x_shifted</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s_1</span><span class="p">)</span> <span class="o">/</span> <span class="n">s_1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">s_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proj_onto_c1</span> <span class="o">=</span> <span class="n">c_cos_shifted</span> <span class="o">*</span> <span class="n">c_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proj_onto_s1</span> <span class="o">=</span> <span class="n">c_sin_shifted</span> <span class="o">*</span> <span class="n">s_1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reconstructed</span> <span class="o">=</span> <span class="n">proj_onto_c1</span> <span class="o">+</span> <span class="n">proj_onto_s1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">reconstructed</span><span class="p">)</span>
<span class="go">[...]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reconstructed shifted cosine&#39;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">reconstructed</span><span class="p">,</span> <span class="n">cos_x_shifted</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//fourier_no_ei_orig-42.png">png</a>, <a class="reference external" href=".//fourier_no_ei_orig-42.hires.png">hires.png</a>, <a class="reference external" href=".//fourier_no_ei_orig-42.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/fourier_no_ei_orig-42.png" src="_images/fourier_no_ei_orig-42.png" />
</figure>
<p>The reason that this works for any phase shift is the angle sum rule.</p>
<p>The angle sum rule is:</p>
<div class="math notranslate nohighlight">
\[\cos(\alpha \pm \beta) = \cos \alpha \cos \beta \mp \sin \alpha \sin \beta\]</div>
<p>To unpack the <span class="math notranslate nohighlight">\(\pm, \mp\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\cos(\alpha + \beta) = \cos \alpha \cos \beta - \sin \alpha \sin \beta \\
\cos(\alpha - \beta) = \cos \alpha \cos \beta + \sin \alpha \sin \beta\end{split}\]</div>
<p>See <a class="reference external" href="https://perrin.dynevor.org/angle_sum.html">angle sum proof</a> for
a visual proof in the case of real angles <span class="math notranslate nohighlight">\(\alpha, \beta\)</span>.</p>
<ul class="simple">
<li><p><a class="reference download internal" href="fourier_no_ei_orig.py">Download this page as a Python code file</a>;</p></li>
<li><p><a class="reference download internal" href="fourier_no_ei_orig.ipynb">Download this page as a Jupyter notebook (no outputs)</a>.</p></li>
</ul>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Teaching</a></h1>



<p class="blurb">Teaching</p>







<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="angle_sum.html">The angle sum rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonferroni_correction.html">Notes on the Bonferroni threshold</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlated_regressors.html">Correlated regressors</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdr.html">Thresholding with false discovery rate</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating_point.html">Points on floats</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating_error.html">Floating point error</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier_basis.html">The Fourier basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier_no_ei.html">Fourier without the ei</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fourier without the ei</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-hard-is-the-mathematics">How hard is the mathematics?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-and-configuring-code-libraries">Loading and configuring code libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-actual-numbers-to-start">Some actual numbers to start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rewriting-the-dft-without-the-e-i">Rewriting the DFT without the <span class="math notranslate nohighlight">\(e^i\)</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dft-and-fft">DFT and FFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#introducing-the-discrete-fourier-transform">Introducing the discrete Fourier transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scrubbing-the-e-i">Scrubbing the <span class="math notranslate nohighlight">\(e^i\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#back-to-scrubbing-the-e-i">Back to scrubbing the <span class="math notranslate nohighlight">\(e^i\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewriting-as-dot-products">Rewriting as dot products</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewriting-the-dft-with-cosine-and-sine-basis-matrices">Rewriting the DFT with cosine and sine basis matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#displaying-the-dft-transform">Displaying the DFT transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="#real-and-complex-input-to-the-dft">Real and complex input to the DFT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-properties-of-the-cosine-and-sine-basis-matrices">Some properties of the cosine and sine basis matrices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mirror-symmetry">Mirror symmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#matrix-symmetry">Matrix symmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#row-dot-products-and-lengths">Row dot products and lengths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#proof-for-c-s-dot-products">Proof for <span class="math notranslate nohighlight">\(\C, \S\)</span> dot products</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#introducing-vector-projection">Introducing vector projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forward-and-inverse-dft-as-vector-projection">Forward and inverse DFT as vector projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#projection-and-the-dft">Projection and the DFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-first-element-in-vec-x-for-real-input">The first element in <span class="math notranslate nohighlight">\(\vec{X}\)</span> for real input</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dft-of-a-constant-input-vector">DFT of a constant input vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cosines-in-the-real-part-sines-in-the-imaginary-part">Cosines in the real part, sines in the imaginary part</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dft-on-a-signal-with-a-single-cosine">DFT on a signal with a single cosine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fitting-all-cosine-phases-with-an-added-sine">Fitting all cosine phases with an added sine</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glm_intro.html">Introduction to the general linear model</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html">The argument in “Why most published research findings are false”</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#the-practice-of-science-is-profoundly-broken-discuss-no-model-and-test">“The practice of science is profoundly broken”. Discuss? - no - model and test!</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#different-ways-of-phrasing-the-argument">Different ways of phrasing the argument</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#some-terms">Some terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#what-does-a-significant-statistical-test-result-tell-us">What does a “significant” statistical test result tell us?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#what-is-a-finding-that-is-likely-to-be-true">What is a finding that is likely to be true?</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#whether-a-finding-is-likely-to-be-true-depends-on-the-power-of-the-experiment">Whether a finding is likely to be true depends on the power of the experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#quantifying-the-effect-of-bias">Quantifying the effect of bias</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#the-effect-of-multiple-studies">The effect of multiple studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioannidis_2005.html#putting-it-together">Putting it together</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutual_information.html">Mutual information as an image matching metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="notation.html">Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizing_space.html">Calculating transformations between images</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_convolution.html">Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_vectors.html">Vectors and dot products</a></li>
<li class="toctree-l1"><a class="reference internal" href="pca_introduction.html">Introducing principal component analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_complex.html">Refresher on complex numbers</a></li>
<li class="toctree-l1"><a class="reference internal" href="slice_timing.html">Slice timing correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoothing_intro.html">An introduction to smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="smoothing_as_convolution.html">Smoothing as convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="some_sums.html">Some algebra with summation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sums_of_cosines.html">Sum of sines and cosines</a></li>
<li class="toctree-l1"><a class="reference internal" href="sums_of_sinusoids.html">Sums of sinusoids</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_fields.html">Thresholding with random field theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Teaching repo</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotation_2d.html">Formula for rotating a vector in 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_projection.html">Vector projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="vector_angles.html">Angles between vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlation_projection.html">Correlation and projection</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix_rank.html">Matrix rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_interpolation.html">Linear interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_cdfs.html">p values from cumulative distribution functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions_are_objects.html">Functions are objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="global_scope.html">Global and local scope of Python variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="brisk_python.html">Brisk introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="string_formatting.html">Inserting values into strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="on_loops.html">“for” and “while”, “break” and “else:”</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="http://matthew.dynevor.org">Home page</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="fourier_no_ei.html" title="previous chapter">Fourier without the ei</a></li>
      <li>Next: <a href="glm_intro.html" title="next chapter">Introduction to the general linear model</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2016, Matthew Brett.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/fourier_no_ei_orig.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>